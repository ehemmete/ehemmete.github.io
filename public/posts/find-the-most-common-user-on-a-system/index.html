<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Find the most common user on a system | My Thoughts</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="I wrote this shell script for a client that was using JAMF&rsquo;s Casper Suite.  It is in the form of an extended attribute, but can easily be changed to output as you want. The script uses the last command to find all the previous logins and then finds the most common user and reports it.  If less than 10 logins have occurred, the script reports the most recent login.```
#!/bin/sh">
    <meta name="generator" content="Hugo 0.135.0">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/posts/find-the-most-common-user-on-a-system/">
    

    <meta property="og:url" content="http://localhost:1313/posts/find-the-most-common-user-on-a-system/">
  <meta property="og:site_name" content="My Thoughts">
  <meta property="og:title" content="Find the most common user on a system">
  <meta property="og:description" content="I wrote this shell script for a client that was using JAMF’s Casper Suite. It is in the form of an extended attribute, but can easily be changed to output as you want. The script uses the last command to find all the previous logins and then finds the most common user and reports it. If less than 10 logins have occurred, the script reports the most recent login.``` #!/bin/sh">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2013-11-07T01:46:51+00:00">
    <meta property="article:modified_time" content="2013-11-07T01:46:51+00:00">
    <meta property="article:tag" content="OS X General">
    <meta property="article:tag" content="Shell Script">

  <meta itemprop="name" content="Find the most common user on a system">
  <meta itemprop="description" content="I wrote this shell script for a client that was using JAMF’s Casper Suite. It is in the form of an extended attribute, but can easily be changed to output as you want. The script uses the last command to find all the previous logins and then finds the most common user and reports it. If less than 10 logins have occurred, the script reports the most recent login.``` #!/bin/sh">
  <meta itemprop="datePublished" content="2013-11-07T01:46:51+00:00">
  <meta itemprop="dateModified" content="2013-11-07T01:46:51+00:00">
  <meta itemprop="wordCount" content="320">
  <meta itemprop="keywords" content="OS X General,Shell Script">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Find the most common user on a system">
  <meta name="twitter:description" content="I wrote this shell script for a client that was using JAMF’s Casper Suite. It is in the form of an extended attribute, but can easily be changed to output as you want. The script uses the last command to find all the previous logins and then finds the most common user and reports it. If less than 10 logins have occurred, the script reports the most recent login.``` #!/bin/sh">

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        My Thoughts
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Find the most common user on a system</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2013-11-07T01:46:51Z">November 7, 2013</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>I wrote this shell script for a client that was using JAMF&rsquo;s Casper Suite.  It is in the form of an extended attribute, but can easily be changed to output as you want. The script uses the last command to find all the previous logins and then finds the most common user and reports it.  If less than 10 logins have occurred, the script reports the most recent login.```
#!/bin/sh</p>
<h1 id="eric-hemmeter---2012">Eric Hemmeter - 2012</h1>
<h1 id="reports-the-most-common-user-out-of-the-last-10-logins">Reports the most common user out of the last 10 logins</h1>
<h1 id="if-there-are-less-than-10-logins-it-reports-the-most-recent-user">If there are less than 10 logins, it reports the most recent user </h1>
<h1 id="a-very-handy-function-to-check-if-a-string-is-in-an-array">a very handy function to check if a string is in an array </h1>
<h1 id="usage-as-follows-containselement-string-to-look-for-array-to-look-in">usage as follows: containsElement &ldquo;$string to look for&rdquo; &ldquo;${array to look in[@]}&rdquo;</h1>
<h1 id="if-the-string-is-found-returns-0-else-returns-1-check--to-find-result">if the string is found, returns 0.  Else returns 1.  Check $? to find result</h1>
<p>containsElement () {
  local e
  for e in &ldquo;${@:2}&rdquo;; do [[ &ldquo;$e&rdquo; == &ldquo;$1&rdquo; ]] &amp;&amp; return 0; done
  return 1
} </p>
<h1 id="gets-the-list-of-previous-logins-at-the-login-window">gets the list of previous logins at the login window</h1>
<h1 id="this-ignores-any-tty-command-line-logins">this ignores any tty (command line) logins</h1>
<p>userList=($(last -t console | cut -d &quot; &quot; -f 1))
numOfUsers=${#userList[@]} </p>
<h1 id="if-less-than-10-logins-return-the-most-recent">if less than 10 logins, return the most recent</h1>
<p>if [ &ldquo;$numOfUsers&rdquo; -lt 10 ]; then
  echo &ldquo;${userList[0]}&rdquo;
  exit 1
fi</p>
<h1 id="find-the-list-of-unique-entries-in-the-user-list">find the list of unique entries in the user list</h1>
<p>uniqueList[0]=&quot;${userList[0]}&quot; 
echo &quot;&quot; &gt; /tmp/userList.txt
echo &quot;&quot; &gt; /tmp/uniqueList.txt </p>
<h1 id="go-through-the-list-of-last-10-logins">go through the list of last 10 logins</h1>
<h1 id="if-this-is-the-first-time-we-see-the-name-add-them-to-the-unique-list-array">if this is the first time we see the name add them to the unique list array</h1>
<p>for i in {0..9}
do
containsElement &ldquo;${userList[$i]}&rdquo; &ldquo;${uniqueList[@]}&rdquo;
contains=$?
  if [ &ldquo;$contains&rdquo; == &ldquo;1&rdquo; ]; then
    uniqueList=(&quot;${uniqueList[@]}&quot; &ldquo;${userList[$i]}&rdquo;)
  fi
echo &ldquo;${userList[$i]}&rdquo; &raquo; /tmp/userList.txt
echo &ldquo;${uniqueList[$i]}&rdquo; &raquo; /tmp/uniqueList.txt
done </p>
<h1 id="this-complex-one-liner-takes-a-list-in-one-file-uniquelist">this complex one liner takes a list in one file (uniqueList)</h1>
<h1 id="and-finds-the-most-common-occurrence-in-the-other-userlist">and finds the most common occurrence in the other (userList)</h1>
<p>result=$(grep -Ff /tmp/uniqueList.txt /tmp/userList.txt | sort | uniq -c | sort -n | tail -n1)
result=${result:5}
echo &ldquo;<!-- raw HTML omitted -->$result<!-- raw HTML omitted -->&rdquo;</p>
<pre tabindex="0"><code></code></pre><ul class="pa0">
  
   <li class="list di">
     <a href="/tags/os-x-general/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">OS X General</a>
   </li>
  
   <li class="list di">
     <a href="/tags/shell-script/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Shell Script</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/posts/keyboard-shortcut-for-system-preferences/">Keyboard shortcut for System Preferences</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/posts/control-if-a-window-opens-when-a-volume-mounts/">Control if a window opens when a volume mounts</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Eric Hemmeter 2024 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
