<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Approve UAMDM and repush KEXT Profile | My Thoughts</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="I recently came across a way to have our JAMF JSS resend a failed KEXT whitelist policy triggered from the client end (Retry a failed Profile from a client).  At that point I wasn&rsquo;t sure how I wanted to deploy it during our provisioning process.  I now have a plan to prompt for UAMDM approval and then automatically resend the KEXT profile.

#!/bin/bash#!/bin/bash
while ! $(profiles status -type enrollment | grep -q &#34;User Approved&#34;); do 
 open /System/Library/PreferencePanes/Profiles.prefPane
 sleep 10
done
curl -sku &#34;$apiuser&#34;:&#34;$apipass&#34; -H &#34;Content-Type: application/xml&#34; -d &#34;&lt;os\_x\_configuration\_profile&gt;&lt;general&gt;&lt;redeploy\_on\_update&gt;Newly Assigned&lt;/redeploy\_on\_update&gt;&lt;/general&gt;&lt;/os\_x\_configuration\_profile&gt;&#34; &#34;$jssurl&#34;/JSSResource/osxconfigurationprofiles/id/$id -X PUT

You will need to supply the username, password, url, and the id number of your Kext profile in your script. I install this script as a login-once action for Outset.  When the user or tech provisioning the Mac signs in after JAMF Imaging is complete, they will see warnings for unapproved kernel extensions. But once the script runs, System Preferences will open to the Profiles pane and keep opening if the user closes it.  Once they approve the MDM Profile, the script triggers the JSS to resend the KEXT profile, which some applications notice immediately. I may add a JAMF helper dialog explaining what to do and will probably add an OS version check as the profiles status line only works in 10.13.4 and above. Thanks to Rich Trouton for a method to check for UAMDM.">
    <meta name="generator" content="Hugo 0.135.0">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/posts/approve-uamdm-and-repush-kext-profile/">
    

    <meta property="og:url" content="http://localhost:1313/posts/approve-uamdm-and-repush-kext-profile/">
  <meta property="og:site_name" content="My Thoughts">
  <meta property="og:title" content="Approve UAMDM and repush KEXT Profile">
  <meta property="og:description" content="I recently came across a way to have our JAMF JSS resend a failed KEXT whitelist policy triggered from the client end (Retry a failed Profile from a client). At that point I wasn’t sure how I wanted to deploy it during our provisioning process. I now have a plan to prompt for UAMDM approval and then automatically resend the KEXT profile.
#!/bin/bash#!/bin/bash while ! $(profiles status -type enrollment | grep -q &#34;User Approved&#34;); do open /System/Library/PreferencePanes/Profiles.prefPane sleep 10 done curl -sku &#34;$apiuser&#34;:&#34;$apipass&#34; -H &#34;Content-Type: application/xml&#34; -d &#34;&lt;os\_x\_configuration\_profile&gt;&lt;general&gt;&lt;redeploy\_on\_update&gt;Newly Assigned&lt;/redeploy\_on\_update&gt;&lt;/general&gt;&lt;/os\_x\_configuration\_profile&gt;&#34; &#34;$jssurl&#34;/JSSResource/osxconfigurationprofiles/id/$id -X PUT You will need to supply the username, password, url, and the id number of your Kext profile in your script. I install this script as a login-once action for Outset. When the user or tech provisioning the Mac signs in after JAMF Imaging is complete, they will see warnings for unapproved kernel extensions. But once the script runs, System Preferences will open to the Profiles pane and keep opening if the user closes it. Once they approve the MDM Profile, the script triggers the JSS to resend the KEXT profile, which some applications notice immediately. I may add a JAMF helper dialog explaining what to do and will probably add an OS version check as the profiles status line only works in 10.13.4 and above. Thanks to Rich Trouton for a method to check for UAMDM.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2018-05-23T15:52:57+00:00">
    <meta property="article:modified_time" content="2018-05-23T15:52:57+00:00">
    <meta property="article:tag" content="Uncategorized">

  <meta itemprop="name" content="Approve UAMDM and repush KEXT Profile">
  <meta itemprop="description" content="I recently came across a way to have our JAMF JSS resend a failed KEXT whitelist policy triggered from the client end (Retry a failed Profile from a client). At that point I wasn’t sure how I wanted to deploy it during our provisioning process. I now have a plan to prompt for UAMDM approval and then automatically resend the KEXT profile.
#!/bin/bash#!/bin/bash while ! $(profiles status -type enrollment | grep -q &#34;User Approved&#34;); do open /System/Library/PreferencePanes/Profiles.prefPane sleep 10 done curl -sku &#34;$apiuser&#34;:&#34;$apipass&#34; -H &#34;Content-Type: application/xml&#34; -d &#34;&lt;os\_x\_configuration\_profile&gt;&lt;general&gt;&lt;redeploy\_on\_update&gt;Newly Assigned&lt;/redeploy\_on\_update&gt;&lt;/general&gt;&lt;/os\_x\_configuration\_profile&gt;&#34; &#34;$jssurl&#34;/JSSResource/osxconfigurationprofiles/id/$id -X PUT You will need to supply the username, password, url, and the id number of your Kext profile in your script. I install this script as a login-once action for Outset. When the user or tech provisioning the Mac signs in after JAMF Imaging is complete, they will see warnings for unapproved kernel extensions. But once the script runs, System Preferences will open to the Profiles pane and keep opening if the user closes it. Once they approve the MDM Profile, the script triggers the JSS to resend the KEXT profile, which some applications notice immediately. I may add a JAMF helper dialog explaining what to do and will probably add an OS version check as the profiles status line only works in 10.13.4 and above. Thanks to Rich Trouton for a method to check for UAMDM.">
  <meta itemprop="datePublished" content="2018-05-23T15:52:57+00:00">
  <meta itemprop="dateModified" content="2018-05-23T15:52:57+00:00">
  <meta itemprop="wordCount" content="228">
  <meta itemprop="keywords" content="Uncategorized">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Approve UAMDM and repush KEXT Profile">
  <meta name="twitter:description" content="I recently came across a way to have our JAMF JSS resend a failed KEXT whitelist policy triggered from the client end (Retry a failed Profile from a client). At that point I wasn’t sure how I wanted to deploy it during our provisioning process. I now have a plan to prompt for UAMDM approval and then automatically resend the KEXT profile.
#!/bin/bash#!/bin/bash while ! $(profiles status -type enrollment | grep -q &#34;User Approved&#34;); do open /System/Library/PreferencePanes/Profiles.prefPane sleep 10 done curl -sku &#34;$apiuser&#34;:&#34;$apipass&#34; -H &#34;Content-Type: application/xml&#34; -d &#34;&lt;os\_x\_configuration\_profile&gt;&lt;general&gt;&lt;redeploy\_on\_update&gt;Newly Assigned&lt;/redeploy\_on\_update&gt;&lt;/general&gt;&lt;/os\_x\_configuration\_profile&gt;&#34; &#34;$jssurl&#34;/JSSResource/osxconfigurationprofiles/id/$id -X PUT You will need to supply the username, password, url, and the id number of your Kext profile in your script. I install this script as a login-once action for Outset. When the user or tech provisioning the Mac signs in after JAMF Imaging is complete, they will see warnings for unapproved kernel extensions. But once the script runs, System Preferences will open to the Profiles pane and keep opening if the user closes it. Once they approve the MDM Profile, the script triggers the JSS to resend the KEXT profile, which some applications notice immediately. I may add a JAMF helper dialog explaining what to do and will probably add an OS version check as the profiles status line only works in 10.13.4 and above. Thanks to Rich Trouton for a method to check for UAMDM.">

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        My Thoughts
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Approve UAMDM and repush KEXT Profile</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2018-05-23T15:52:57Z">May 23, 2018</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>I recently came across a way to have our JAMF JSS resend a failed KEXT whitelist policy triggered from the client end (<a href="https://sneakypockets.wordpress.com/2018/05/21/retry-a-failed-profile-from-a-client/">Retry a failed Profile from a client</a>).  At that point I wasn&rsquo;t sure how I wanted to deploy it during our provisioning process.  I now have a plan to prompt for UAMDM approval and then automatically resend the KEXT profile.</p>
<blockquote>
<pre tabindex="0"><code>#!/bin/bash#!/bin/bash
while ! $(profiles status -type enrollment | grep -q &#34;User Approved&#34;); do 
 open /System/Library/PreferencePanes/Profiles.prefPane
 sleep 10
done
curl -sku &#34;$apiuser&#34;:&#34;$apipass&#34; -H &#34;Content-Type: application/xml&#34; -d &#34;&lt;os\_x\_configuration\_profile&gt;&lt;general&gt;&lt;redeploy\_on\_update&gt;Newly Assigned&lt;/redeploy\_on\_update&gt;&lt;/general&gt;&lt;/os\_x\_configuration\_profile&gt;&#34; &#34;$jssurl&#34;/JSSResource/osxconfigurationprofiles/id/$id -X PUT
</code></pre></blockquote>
<p>You will need to supply the username, password, url, and the id number of your Kext profile in your script. I install this script as a login-once action for <a href="https://github.com/chilcote/outset">Outset</a>.  When the user or tech provisioning the Mac signs in after JAMF Imaging is complete, they will see warnings for unapproved kernel extensions.<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2018/05/screen-shot-2018-03-27-at-9-42-45-am.png" alt="Screen Shot 2018-03-27 at 9.42.45 AM.png"> But once the script runs, System Preferences will open to the Profiles pane and keep opening if the user closes it.  Once they approve the MDM Profile, the script triggers the JSS to resend the KEXT profile, which some applications notice immediately.<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2018/05/screen-shot-2018-03-27-at-9-44-22-am.png" alt="Screen Shot 2018-03-27 at 9.44.22 AM.png"> I may add a JAMF helper dialog explaining what to do and will probably add an OS version check as the profiles status line only works in 10.13.4 and above. Thanks to Rich Trouton for <a href="https://derflounder.wordpress.com/2018/03/30/detecting-user-approved-mdm-using-the-profiles-command-line-tool-on-macos-10-13-4/">a method to check for UAMDM</a>.</p>
<ul class="pa0">
  
   <li class="list di">
     <a href="/tags/uncategorized/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Uncategorized</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/posts/retry-a-failed-profile-from-a-client/">Retry a failed Profile from a client</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/posts/filecruiser-where-are-my-files/">FileCruiser - Where are my files?</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/posts/network-services-and-ips/">Network Services and IPs</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Eric Hemmeter 2024 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
