<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on My Thoughts</title>
    <link>http://localhost:1313/posts/</link>
    <description>Recent content in Posts on My Thoughts</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <copyright>Eric Hemmeter</copyright>
    <lastBuildDate>Wed, 29 Nov 2023 01:51:20 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/posts/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Virtualizing macOS with copy/paste and drag &amp;amp; drop</title>
      <link>http://localhost:1313/posts/virtualizing-macos-with-copy-paste-and-drag-drop-comments/</link>
      <pubDate>Wed, 29 Nov 2023 01:51:20 +0000</pubDate>
      <guid>http://localhost:1313/posts/virtualizing-macos-with-copy-paste-and-drag-drop-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;%22dricci@rma.edu%22&#34;&gt;Dan&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Nov 3, 2023&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;How does this work with serial numbers? Can you enroll an Apple Silicon VM into an MDM for testing purposes?&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;&#xA;&lt;p&gt;No, I&amp;rsquo;m not aware of any way to do that on M# series Macs.&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;</description>
    </item>
    <item>
      <title>Virtualizing macOS with copy/paste and drag &amp;amp; drop</title>
      <link>http://localhost:1313/posts/virtualizing-macos-with-copy-paste-and-drag-drop/</link>
      <pubDate>Wed, 29 Nov 2023 01:51:20 +0000</pubDate>
      <guid>http://localhost:1313/posts/virtualizing-macos-with-copy-paste-and-drag-drop/</guid>
      <description>&lt;p&gt;With Apple adding their &lt;a href=&#34;https://developer.apple.com/documentation/virtualization&#34;&gt;Virtualization&lt;/a&gt; &lt;a href=&#34;https://developer.apple.com/documentation/virtualization&#34;&gt;Framework&lt;/a&gt;, there are several options for virtualizing macOS (and others) on our M# based Macs. I use VMs for connecting to some of our customer networks that require full-tunnel VPN. One common complaint is that these don&amp;rsquo;t offer copy/paste or drag and drop from the host to or from the guest. A workaround for this is to use Apple&amp;rsquo;s Screen Sharing or Remote Desktop application to connect to the VM. Because of this, I like to use &lt;a href=&#34;https://github.com/cirruslabs/tart&#34;&gt;Tart&lt;/a&gt; as my VM software because it offers a no gui option. I have an AppleScript start it up in a particular way.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Swift mountshare command line tool</title>
      <link>http://localhost:1313/posts/swift-mountshare-command-line-tool/</link>
      <pubDate>Mon, 03 Jul 2023 09:52:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/swift-mountshare-command-line-tool/</guid>
      <description>&lt;p&gt;There have been many times over the years of my career where I have wanted to script mounting a file share for a user. There are several ways to make this happen from manually adding a file share to a user&amp;rsquo;s Login Items, using AppleScript, and scripting the &lt;code&gt;mount&lt;/code&gt; command. Eventually I found and settled on using a python script with the python objc bridge from an &lt;a href=&#34;https://gist.github.com/pudquick/1362a8908be01e23041d&#34;&gt;old frogor/pudquick gist&lt;/a&gt;. This worked great with the built in python on macOS and uses the same bits of the OS that the Connect to Server… dialog does. I was able to &lt;a href=&#34;https://sneakypockets.wordpress.com/2016/09/26/mounting-file-shares-based-on-ad-group-membership-using-enterprise-connect/&#34;&gt;automatically mount shares based on AD group&lt;/a&gt; at a previous job using this script. Eventually Apple stopped including python in macOS, so I had to &lt;a href=&#34;https://github.com/macadmins/python&#34;&gt;install another one&lt;/a&gt;. There were some modifications needed to make it work with python 3 (see the comments on the gist) and installing python everywhere for this one thing seemed like overkill. So I started working on a Swift implementation using &lt;a href=&#34;https://swiftpackageindex.com/apple/swift-argument-parser/1.2.2/documentation/argumentparser&#34;&gt;swift argument parser&lt;/a&gt;. Since the python script calls into the system a lot of the pieces were already laid out and then I found a mosen &lt;a href=&#34;https://gist.github.com/mosen/2ddf85824fbb5564aef527b60beb4669&#34;&gt;gist that laid out basically all the options and proper terms&lt;/a&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Moving to Mastodon and that other blog</title>
      <link>http://localhost:1313/posts/moving-to-mastodon-and-that-other-blog/</link>
      <pubDate>Tue, 20 Dec 2022 21:15:59 +0000</pubDate>
      <guid>http://localhost:1313/posts/moving-to-mastodon-and-that-other-blog/</guid>
      <description>&lt;p&gt;Like many others I&amp;rsquo;m fed up with what is going on at Twitter and closed my account. I was never much of a poster, but I did like keeping up with news (primarily #macadmin) there. So I&amp;rsquo;ve moved to Mastodon. Turns out I had created an account on mastodon.social a few years ago, so I am now &lt;a href=&#34;https://mastodon.social/@ehemmete&#34;&gt;over there&lt;/a&gt; for my social media needs.&lt;/p&gt;&#xA;&lt;p&gt;Also I don&amp;rsquo;t post here much anymore. Anything I do for work goes to the &lt;a href=&#34;https://www.rskgroup.org/blog/&#34;&gt;RSKGroup blog&lt;/a&gt; and that takes most of my blogging time/energy.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Creating a wrapper package for a choices.xml file</title>
      <link>http://localhost:1313/posts/creating-a-wrapper-package-for-a-choices-xml-file-comments/</link>
      <pubDate>Tue, 17 Mar 2020 18:46:06 +0000</pubDate>
      <guid>http://localhost:1313/posts/creating-a-wrapper-package-for-a-choices-xml-file-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;http://azurecloudsujithcy.wordpress.com&#34; title=&#34;sujith.cy@gmail.com&#34;&gt;azureessentials&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Mar 0, 2022&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thanks for writing this article and it is really helpful. I am trying to distribute ciscoanyconnect app to our Intune managed mac devices. The cisco package we have includes all components like posture, AMP, websecurity etc. I&amp;rsquo;d like to exclude all of them except VPN using choice.xml. I followed your post and after I built the package it fails to run. I suspect there is some issue with the postinstall script. please assist me here.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Creating a wrapper package for a choices.xml file</title>
      <link>http://localhost:1313/posts/creating-a-wrapper-package-for-a-choices-xml-file/</link>
      <pubDate>Tue, 17 Mar 2020 18:46:06 +0000</pubDate>
      <guid>http://localhost:1313/posts/creating-a-wrapper-package-for-a-choices-xml-file/</guid>
      <description>&lt;p&gt;In a &lt;a href=&#34;https://sneakypockets.wordpress.com/2017/07/26/using-installer-choices-xml-to-modify-anyconnect-and-mcafee-deployments/&#34;&gt;previous article&lt;/a&gt;, I discussed creating a choices.xml file to control what gets installed by a vendor package.  I briefly touched on how to use the choices.xml file, but don&amp;rsquo;t give much detail.  In this post, I will spell out how to put the vendor package and choices.xml file in a wrapper package for deployment through anything that handles packages. For my example, I will be using Cisco&amp;rsquo;s AnyConnect 4.8 package and a choices.xml file to only install the VPN portion.  Using &lt;a href=&#34;http://s.sudre.free.fr/Software/Packages/about.html&#34;&gt;Stéphane Sudre&amp;rsquo;s Packages&lt;/a&gt; application, create a new raw package project. &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2020/03/screen-shot-2020-03-17-at-12.38.06-pm.png&#34; alt=&#34;Screen Shot 2020-03-17 at 12.38.06 PM&#34;&gt; Give it a useful name and decide where to save the project. &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2020/03/screen-shot-2020-03-17-at-12.38.24-pm.png&#34; alt=&#34;Screen Shot 2020-03-17 at 12.38.24 PM&#34;&gt;You can set Settings how you like, but the defaults generally work for what we are doing. Everything in this exercise will be in the Scripts tab. &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2020/03/screen-shot-2020-03-17-at-12.58.09-pm.png&#34; alt=&#34;Screen Shot 2020-03-17 at 12.58.09 PM&#34;&gt;Drag the AnyConnect.pkg and your choices.xml to the Additional Resources area.  You can name your xml file anything you want.  For example, I have choicesForAnyConnectVPN.xml and choicesForAnyConnectUmbrella.xml for 2 different package projects.  For AnyConnect, I also want to install our vpn configuration, so I add a Profiles folder with the vpn folder and the configuration in there. &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2020/03/screen-shot-2020-03-17-at-12.57.51-pm.png&#34; alt=&#34;Screen Shot 2020-03-17 at 12.57.51 PM&#34;&gt; My company&amp;rsquo;s VPN requires a certificate, so that is added as well.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2020/03/screen-shot-2020-03-17-at-1.38.57-pm.png&#34; alt=&#34;Screen Shot 2020-03-17 at 1.38.57 PM.png&#34;&gt; The AnyConnect.pkg already looks for the Profiles directory in the same directory as the package. Now we need a post installation script to tell the installer binary to use our choices.xml file.  The first step is to find the path to the resources area, which is created by the installer process and cleaned up automatically.  The post install script will be running from that directory, so we can find the path with &lt;code&gt;​dirname&lt;/code&gt;.  Then we tell installer about the choices.xml, the vendor package, and the target volume.  Lastly, I add the certificate to the System Keychain. &lt;a href=&#34;https://gist.github.com/ehemmete/70396684d6ed91687ec4b7f85aa8961b&#34;&gt;https://gist.github.com/ehemmete/70396684d6ed91687ec4b7f85aa8961b&lt;/a&gt; Once the postinstall.sh is created, drag it to the Post-installation well, save your package, and build it. &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2020/03/screen-shot-2020-03-17-at-1.39.44-pm.png&#34; alt=&#34;Screen Shot 2020-03-17 at 1.39.44 PM.png&#34;&gt;I then &lt;a href=&#34;https://sneakypockets.wordpress.com/2016/11/04/signing-installer-packages-with-automator/&#34;&gt;sign my packages&lt;/a&gt; with a certificate from my company&amp;rsquo;s Apple developer account. Lastly, a note about the target for &lt;code&gt;installer&lt;/code&gt;. You could put &lt;code&gt;/&lt;/code&gt; in for the target, but if there is a chance this package will be installed while booted from something other than the internal drive (much more common in the era of imaging), the package will be installed to the boot volume, not the correct target.  Using &lt;code&gt;$3&lt;/code&gt; means put it on the target volume.  Rich Trouton mentions it under Installer Script Variables &lt;a href=&#34;https://derflounder.wordpress.com/2014/06/01/understanding-payload-free-packages/&#34;&gt;here&lt;/a&gt;.  There are also mentions in the old PeachPit &lt;a href=&#34;https://books.google.com/books?id=H3awpzaO7IwC&amp;amp;lpg=PA111&amp;amp;dq=%243%20The%20mount%20point%20of%20the%20destination%20volume&amp;amp;pg=PA111#v=onepage&amp;amp;q=$3%20The%20mount%20point%20of%20the%20destination%20volume&amp;amp;f=false&#34;&gt;Mac OS X Deployment&lt;/a&gt; book.  [edit]And thanks to &lt;a href=&#34;https://scriptingosx.com&#34;&gt;Scripting OS X&lt;/a&gt; for the pointer to double quote &lt;code&gt;$3&lt;/code&gt; in the post install script.  In these cases (where it isn&amp;rsquo;t &lt;code&gt;/&lt;/code&gt;) it will likely expand to &lt;code&gt;/Volumes/Macintosh HD/&lt;/code&gt;​ and the space will cause a problem if not quoted.  He also points out that I hard coded the path to the System Keychain, but&lt;code&gt;security&lt;/code&gt; won&amp;rsquo;t be happy if &lt;code&gt;$3&lt;/code&gt; isn&amp;rsquo;t &lt;code&gt;/&lt;/code&gt;, so this isn&amp;rsquo;t as flexible as I intended.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Fun with AppleScript and Notes</title>
      <link>http://localhost:1313/posts/fun-with-applescript-and-notes/</link>
      <pubDate>Fri, 20 Dec 2019 16:05:53 +0000</pubDate>
      <guid>http://localhost:1313/posts/fun-with-applescript-and-notes/</guid>
      <description>&lt;p&gt;I have pretty large collection of movies ripped from my DVDs and a few Blu-Rays stored on a file server. Occasionally when I want to watch something old that we have, I&amp;rsquo;d rather borrow a Blu-Ray from our library to see it in better quality, but it is hard to remember what movies are DVD quality and which are Blu-Ray. The post will show how I collect that information and made it sync to my iPhone. To collect the resolution information I am using &lt;code&gt;mdls -name kMDItemPixelHeight $movie&lt;/code&gt; and &lt;code&gt;mdls -name kMDItemPixelWidth $movie&lt;/code&gt;. I initially thought about writing this to a static webpage, but didn&amp;rsquo;t want to go to the trouble of setting all that up.  I had visions of launchdaemons and shell scripts to automate it all, but that felt like too much work for a trivial want.  So I started thinking about other ways to get data available on the go and eventually remembered Notes.  That lead to a bit of research, including the always useful &lt;a href=&#34;https://www.macosxautomation.com/applescript/notes/02.html&#34;&gt;MacOSXAutomation&lt;/a&gt; and of course a &lt;a href=&#34;https://apple.stackexchange.com/questions/295569/can-an-applescript-write-to-a-notes-app-document&#34;&gt;StackExchange&lt;/a&gt; post. The fun part is using AppleScript to write to a note in Notes.app which then is synced through iCloud automatically. Notes.app notes use html for formatting which can be pretty powerful. In my case, I just need each entry on its own line. In AppleScript Editor I saved the following as a script and now double click it when I want to update the note.```&#xA;&lt;strong&gt;set&lt;/strong&gt; ss &lt;strong&gt;to&lt;/strong&gt; &amp;ldquo;cd /Volumes/External/Media/Movies&#xA;for movie in *.m*; do&#xA;height=$(mdls -name kMDItemPixelHeight \&amp;quot;$movie\&amp;rdquo; | awk &amp;lsquo;{print $NF}&amp;rsquo;)&#xA;width=$(mdls -name kMDItemPixelWidth \&amp;quot;$movie\&amp;quot; | awk &amp;lsquo;{print $NF}&amp;rsquo;)&#xA;echo \&amp;quot;&lt;!-- raw HTML omitted --&gt;${movie}, ${height}, ${width}&lt;!-- raw HTML omitted --&gt;\&amp;quot;&#xA;done&amp;quot;&#xA;&lt;strong&gt;set&lt;/strong&gt; notebody &lt;strong&gt;to&lt;/strong&gt; &lt;strong&gt;do shell script&lt;/strong&gt; ss&#xA;&lt;strong&gt;tell&lt;/strong&gt; &lt;em&gt;application&lt;/em&gt; &amp;ldquo;Notes&amp;rdquo;&#xA;** activate**&#xA;** tell** default account &lt;strong&gt;to&lt;/strong&gt; &lt;strong&gt;tell&lt;/strong&gt; &lt;em&gt;folder&lt;/em&gt; &amp;ldquo;Notes&amp;rdquo;&#xA;**  set** body &lt;strong&gt;of&lt;/strong&gt; &lt;em&gt;note&lt;/em&gt; &amp;ldquo;Movie Resolutions&amp;rdquo; &lt;strong&gt;to&lt;/strong&gt; notebody&#xA;** end** &lt;strong&gt;tell&lt;/strong&gt;&#xA;&lt;strong&gt;end&lt;/strong&gt; &lt;strong&gt;tell&lt;/strong&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Shell to Swift with a bit of Python</title>
      <link>http://localhost:1313/posts/shell-to-swift-with-a-bit-of-python/</link>
      <pubDate>Mon, 29 Jul 2019 16:13:56 +0000</pubDate>
      <guid>http://localhost:1313/posts/shell-to-swift-with-a-bit-of-python/</guid>
      <description>&lt;p&gt;This is probably the first of a couple of posts about this project. There are a couple of things I learned I want to expand on, but don&amp;rsquo;t want to make this too long. So this will be an overview of the project. For years I have had a &lt;a href=&#34;https://sneakypockets.wordpress.com/2015/05/05/update-to-network-geektool-script/&#34;&gt;shell script&lt;/a&gt; that collected some network info and it was displayed on my desktop using &lt;a href=&#34;http://mutablecode.com/apps/nerdtool.html&#34;&gt;NerdTool&lt;/a&gt; and then &lt;a href=&#34;https://www.tynsoe.org/v2/geektool/&#34;&gt;GeekTool&lt;/a&gt;. While testing macOS Catalina betas, GeekTool hasn&amp;rsquo;t been working for me. The other concern with these options is that they run the shell script on a schedule which can be much to frequent or not frequent enough.  So I &lt;a href=&#34;https://github.com/ehemmete/NetworkInfoGUI&#34;&gt;rewrote it with Xcode in Swift&lt;/a&gt;. I have &lt;a href=&#34;https://sneakypockets.wordpress.com/2019/04/15/using-a-swift-app-to-get-rid-of-lots-of-applescript-dialogs/&#34;&gt;recently been doing more with Swift&lt;/a&gt; and was inspired by &lt;a href=&#34;https://psumac2019.sched.com/event/KQo3/swift-xcode-an-app-and-you&#34;&gt;Macshome&amp;rsquo;s workshop at PSU MacAdmin 2019&lt;/a&gt;. In that workshop he showed off a nice Swift function for running shell scripts (he planned to opensource the workshop code, so I will link to it when I can). He also demonstrated how to store functions in one file and reference them in another which made for much cleaner and transportable code. I started with that and reproduced my network info output and that was working well. At this point the program was a cli command. &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2019/07/screen-shot-2019-07-26-at-8.38.25-pm-1.png&#34; alt=&#34;Screen Shot 2019-07-26 at 8.38.25 PM.png&#34;&gt;While it worked well in the terminal, I wanted to have the output available at a glance. I created a new Xcode project to create a GUI version. Because I had all my functions in a separate NetworkInfo.swift file, I was able to drag that into the GUI project and call them from there.  The main parts of the project now relied on ​​&lt;code&gt;​networksetup&lt;/code&gt; to find all the network services and get the ip addresses of the active services and &lt;a href=&#34;https://github.com/ehemmete/NetworkInfoGUI/blob/master/NetworkFunctions(shell-based).swift&#34;&gt;looked like this&lt;/a&gt;. Then I was further inspired by &lt;a href=&#34;https://macadmins.slack.com/archives/C056UTQ3M/p1563909962029100&#34;&gt;zakes&lt;/a&gt; and &lt;a href=&#34;https://macadmins.slack.com/archives/C056UTQ3M/p1563914551039800&#34;&gt;frogor&lt;/a&gt; in #python in the &lt;a href=&#34;http://macadmins.org&#34;&gt;MacAdmin Slack&lt;/a&gt; to try to use more native calls instead of shell commands.  They were using PyObjC to call native macOS methods, so it was pretty straight forward to use them in Swift after a bit of reading the documentation. I also got some help from &lt;a href=&#34;https://macadmins.slack.com/archives/C0688BNEM/p1563637834003600&#34;&gt;bp&lt;/a&gt; in #swift on getting nicer output from some of the methods. At this point, I could print all the output I wanted nicely, but only when the application is launched. I found &lt;a href=&#34;https://developer.apple.com/documentation/network/nwpathmonitor&#34;&gt;NWPathMonitor in Apple&amp;rsquo;s documentation&lt;/a&gt; and with some trial and error, I was able to get the function to update the UI whenever the network state on the Mac changed.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2019/07/screen-shot-2019-07-26-at-8.56.45-pm.png&#34; alt=&#34;Screen Shot 2019-07-26 at 8.56.45 PM.png&#34;&gt; By moving from shell calls to native methods, the code runs much faster.  Using &lt;code&gt;time&lt;/code&gt; to compare the two commands, the ProcessRunner version runs in 1.155s while the native command version runs in .243s. Certainly not a huge deal for something this simple, but shows the benefit of using the native tools when possible. Another benefit is that by using a native wrapping label in a standard window, the network info is now selectable and copyable. In another post, I plan to describe the structure of the project and how it monitors for network changes.  I also hope to figure out how to use the macOS native controls to allow a user to adjust the fonts, colors, and opacity of the display.  Finally, I would like to include the cli command in the GUI bundle, so it can be called from Terminal if needed.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Change the FileVault login background in Mojave</title>
      <link>http://localhost:1313/posts/change-the-filevault-login-background-in-mojave-comments/</link>
      <pubDate>Thu, 30 May 2019 20:36:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/change-the-filevault-login-background-in-mojave-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;%22ingx@thinkingx.de%22&#34;&gt;ingx&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Sep 4, 2019&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;Dunno why nobody comments on this. Thx a lot! Everbody &amp;ldquo;talks&amp;rdquo; about this problem, but it seems nearly nobody in the &amp;ldquo;mac universe&amp;rdquo; understands what the problem is with activated fileVault and changing the initial login Screen by changing the default mojave picture with a personal one. It works after unlocking fileVault, but not before. Updating the preboot routine helped! Thx a lot again!&lt;/p&gt;</description>
    </item>
    <item>
      <title>Change the FileVault login background in Mojave</title>
      <link>http://localhost:1313/posts/change-the-filevault-login-background-in-mojave/</link>
      <pubDate>Thu, 30 May 2019 20:36:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/change-the-filevault-login-background-in-mojave/</guid>
      <description>&lt;p&gt;There are sites on the internet about changing the Mojave login window background, but nothing I found for when FileVault is enabled.  I think I found a solution. For the login window, the &amp;ldquo;trick&amp;rdquo; is to swap out /Library/Desktop Pictures/Mojave.heic with your image.  It must be the same name and format.  Preview on Mojave can help with converting your image to .heic format. Then to get FileVault to use it, we update the preboot environment/partition with [code]diskutil apfs updatePreboot /[/code] Restart and you should see your custom background. Apple may very well &amp;ldquo;fix&amp;rdquo; this with a/every software update and set it back, but if you really want to brand that screen it is possible for now.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Using a Swift app to get rid of lots of AppleScript dialogs</title>
      <link>http://localhost:1313/posts/using-a-swift-app-to-get-rid-of-lots-of-applescript-dialogs-comments/</link>
      <pubDate>Mon, 15 Apr 2019 13:17:32 +0000</pubDate>
      <guid>http://localhost:1313/posts/using-a-swift-app-to-get-rid-of-lots-of-applescript-dialogs-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.arminip.com/&#34; title=&#34;mtentor@arminip.com&#34;&gt;Marty Tentor&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Feb 5, 2021&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thanks for the example. I have a similar challenge, getting a one window gui for applescipt. Just want to confirm that you are using Swift to generate text files and then running Applescript to get the data from the text files and running the real work on the targeted application. Is the Applescript being run separately,(called by the user) or is the Applescript call coming from within the Swift program?&lt;/p&gt;</description>
    </item>
    <item>
      <title>Using a Swift app to get rid of lots of AppleScript dialogs</title>
      <link>http://localhost:1313/posts/using-a-swift-app-to-get-rid-of-lots-of-applescript-dialogs/</link>
      <pubDate>Mon, 15 Apr 2019 13:17:32 +0000</pubDate>
      <guid>http://localhost:1313/posts/using-a-swift-app-to-get-rid-of-lots-of-applescript-dialogs/</guid>
      <description>&lt;p&gt;There was recently a discussion in #bash in the &lt;a href=&#34;https://macadmins.org&#34;&gt;MacAdmin Slack&lt;/a&gt; about better ways to handle multiple dialogs for gathering info from users or techs.  In my company&amp;rsquo;s provisioning process we want to collect a number of things to be picked up by our inventory system (BigFix).  This started with a set of AppleScript Display Dialogs.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2019/04/applescriptpopups.2019-04-13-12_40_20.gif&#34; alt=&#34;AppleScriptPopUps.2019-04-13 12_40_20.gif&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;This is not a great experience and gets worse as we try to make it less error prone (do you see the mistake?). To make this better for our techs, I wrote a relatively simple Swift application.  I didn&amp;rsquo;t/don&amp;rsquo;t have much Swift experience (just playing around in Playgrounds, a few simple tutorials), so I can&amp;rsquo;t say this is the &amp;ldquo;right&amp;rdquo; way to do this, but it works for me/our process.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Automating making bootable macOS installer dmgs</title>
      <link>http://localhost:1313/posts/automating-making-bootable-macos-installer-dmgs-comments/</link>
      <pubDate>Fri, 21 Sep 2018 20:04:56 +0000</pubDate>
      <guid>http://localhost:1313/posts/automating-making-bootable-macos-installer-dmgs-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;http://macvfx.wordpress.com&#34; title=&#34;mat@matx.ca&#34;&gt;macvfx&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Sep 5, 2018&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;Minor typo: &amp;quot; Instead of manually make&amp;quot;&amp;hellip; I think you meant to say: &amp;quot; Instead of manually _making_&amp;quot;&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;&#xA;&lt;p&gt;Thank you! Fixed.&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;&#xA;&lt;p&gt;Thanks again for creating this. Works with 10.13 and 10,14 dmg supplied by installinstallmacos.py that I tested.&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;</description>
    </item>
    <item>
      <title>Automating making bootable macOS installer dmgs</title>
      <link>http://localhost:1313/posts/automating-making-bootable-macos-installer-dmgs/</link>
      <pubDate>Fri, 21 Sep 2018 20:04:56 +0000</pubDate>
      <guid>http://localhost:1313/posts/automating-making-bootable-macos-installer-dmgs/</guid>
      <description>&lt;p&gt;macOS Mojave should be released on Mon (9/24). At my employer, we will not be ready to support it yet as we are waiting for a couple of vendors to update their products. So we will need to be able to build High Sierra Macs without relying on Internet Recovery for erasing and reinstalling macOS. To make things more confusing, macOS High Sierra doesn&amp;rsquo;t have a unified installer for all models. Most use 17G65, but the 2018 MacBook Pros need 17G2208. Both can be downloaded today (before Mojave comes out) with &lt;a href=&#34;https://github.com/munki/macadmin-scripts/blob/master/installinstallmacos.py&#34;&gt;installinstallmacos.py&lt;/a&gt;.  Instead of manually making USB drives with createinstallmedia for both and then making dmgs to distribute to our deskside team across the country, I wanted to automate this process. I wrote a script that takes the output of installinstallmacos.py as input, creates an empty writable disk image, uses the createinstallmedia command to make the new disk image a bootable macOS installer, converts the installer dmg to compressed, and scans it for restore.  I have tested it with both High Sierra and Mojave installers. See &lt;a href=&#34;https://github.com/ehemmete/makeBootableInstaller&#34;&gt;makeBootableInstaller&lt;/a&gt; for the script and details. The way to use it is to first use installinstallmacos.py to download the version and build you need.  Then run:&lt;/p&gt;</description>
    </item>
    <item>
      <title>Approve UAMDM and repush KEXT Profile</title>
      <link>http://localhost:1313/posts/approve-uamdm-and-repush-kext-profile/</link>
      <pubDate>Wed, 23 May 2018 15:52:57 +0000</pubDate>
      <guid>http://localhost:1313/posts/approve-uamdm-and-repush-kext-profile/</guid>
      <description>&lt;p&gt;I recently came across a way to have our JAMF JSS resend a failed KEXT whitelist policy triggered from the client end (&lt;a href=&#34;https://sneakypockets.wordpress.com/2018/05/21/retry-a-failed-profile-from-a-client/&#34;&gt;Retry a failed Profile from a client&lt;/a&gt;).  At that point I wasn&amp;rsquo;t sure how I wanted to deploy it during our provisioning process.  I now have a plan to prompt for UAMDM approval and then automatically resend the KEXT profile.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#!/bin/bash#!/bin/bash&#xA;while ! $(profiles status -type enrollment | grep -q &amp;#34;User Approved&amp;#34;); do &#xA; open /System/Library/PreferencePanes/Profiles.prefPane&#xA; sleep 10&#xA;done&#xA;curl -sku &amp;#34;$apiuser&amp;#34;:&amp;#34;$apipass&amp;#34; -H &amp;#34;Content-Type: application/xml&amp;#34; -d &amp;#34;&amp;lt;os\_x\_configuration\_profile&amp;gt;&amp;lt;general&amp;gt;&amp;lt;redeploy\_on\_update&amp;gt;Newly Assigned&amp;lt;/redeploy\_on\_update&amp;gt;&amp;lt;/general&amp;gt;&amp;lt;/os\_x\_configuration\_profile&amp;gt;&amp;#34; &amp;#34;$jssurl&amp;#34;/JSSResource/osxconfigurationprofiles/id/$id -X PUT&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;You will need to supply the username, password, url, and the id number of your Kext profile in your script. I install this script as a login-once action for &lt;a href=&#34;https://github.com/chilcote/outset&#34;&gt;Outset&lt;/a&gt;.  When the user or tech provisioning the Mac signs in after JAMF Imaging is complete, they will see warnings for unapproved kernel extensions.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2018/05/screen-shot-2018-03-27-at-9-42-45-am.png&#34; alt=&#34;Screen Shot 2018-03-27 at 9.42.45 AM.png&#34;&gt; But once the script runs, System Preferences will open to the Profiles pane and keep opening if the user closes it.  Once they approve the MDM Profile, the script triggers the JSS to resend the KEXT profile, which some applications notice immediately.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2018/05/screen-shot-2018-03-27-at-9-44-22-am.png&#34; alt=&#34;Screen Shot 2018-03-27 at 9.44.22 AM.png&#34;&gt; I may add a JAMF helper dialog explaining what to do and will probably add an OS version check as the profiles status line only works in 10.13.4 and above. Thanks to Rich Trouton for &lt;a href=&#34;https://derflounder.wordpress.com/2018/03/30/detecting-user-approved-mdm-using-the-profiles-command-line-tool-on-macos-10-13-4/&#34;&gt;a method to check for UAMDM&lt;/a&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Retry a failed Profile from a client</title>
      <link>http://localhost:1313/posts/retry-a-failed-profile-from-a-client-comments/</link>
      <pubDate>Mon, 21 May 2018 21:09:13 +0000</pubDate>
      <guid>http://localhost:1313/posts/retry-a-failed-profile-from-a-client-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://sneakypockets.wordpress.com/2018/05/23/approve-uamdm-and-repush-kext-profile/&#34; title=&#34;&#34;&gt;Approve UAMDM and repush KEXT Profile | My Thoughts&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;May 3, 2018&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;[…] a way to have our JAMF JSS resend a failed KEXT whitelist policy triggered from the client end (Retry a failed Profile from a client).  At that point I wasn’t sure how I wanted to deploy it during our provisioning process. […]&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;</description>
    </item>
    <item>
      <title>Retry a failed Profile from a client</title>
      <link>http://localhost:1313/posts/retry-a-failed-profile-from-a-client/</link>
      <pubDate>Mon, 21 May 2018 21:09:13 +0000</pubDate>
      <guid>http://localhost:1313/posts/retry-a-failed-profile-from-a-client/</guid>
      <description>&lt;p&gt;My organization is working on moving to a DEP based workflow, but in the meantime we are getting computers that have 10.13.4 preinstalled on them. We use JAMF Imaging along with the Apple provided OS to put our software on the Mac and enroll it into our JAMF JSS. After the build process the user can log in, but in 10.13.4 they are shown unapproved kernel extension warnings because our MDM Profile is not yet approved. Once they approve the MDM Profile, our KEXT Whitelist still needs to be pushed again. I can manually do this from the JAMF console by choosing to edit the profile, then save it immediately. When prompted, I have it push to newly assigned clients only and it doesn&amp;rsquo;t bother the several hundred that already have it. I recently figured out how to prompt for this from the client end with the JAMF API. Each JAMF configuration profile (osxconfigurationprofiles in API terms) has a redploy_on_update key that can take a value of Newly Assigned. Using the API to PUT this value seems to trigger the same behaviour as the edit/save/assign to new devices process. So now from the client (or Self Service) I can trigger the KEXT profile repush as needed while still not touching all the devices that are already happy. The API call looks like:&lt;code&gt;curl -sku &amp;quot;$apiUser&amp;quot;:&amp;quot;$apiPass&amp;quot; -H &amp;quot;Content-Type: application/xml&amp;quot; -d &amp;quot;&amp;lt;os\_x\_configuration\_profile&amp;gt;&amp;lt;general&amp;gt;&amp;lt;redeploy\_on\_update&amp;gt;Newly Assigned&amp;lt;/redeploy\_on\_update&amp;gt;&amp;lt;/general&amp;gt;&amp;lt;/os\_x\_configuration\_profile&amp;gt;&amp;quot; https://jss.company.com:8443/JSSResource/osxconfigurationprofiles/id/&amp;quot;$id&amp;quot; -X PUT&lt;/code&gt;For the API user, I created a new local JSS account that has Update privileges for macOS Configuration Profiles (note the difference between the API and the GUI). See &lt;a href=&#34;https://www.rderewianko.com/hardcoding_is_bad/&#34;&gt;https://www.rderewianko.com/hardcoding_is_bad/&lt;/a&gt; for some good ideas on passing the username/password/JSS name in a script. Lastly we need the id of the configuration profile we want to repush. This can found in the URL of the profile in the web GUI or via the API. &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2018/05/screen-shot-2018-05-21-at-3-28-16-pm.png&#34; alt=&#34;Screen Shot 2018-05-21 at 3.28.16 PM.png&#34;&gt; or &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2018/05/screen-shot-2018-05-21-at-3-28-52-pm.png&#34; alt=&#34;Screen Shot 2018-05-21 at 3.28.52 PM.png&#34;&gt; or```&#xA;curl -sku &amp;ldquo;$apiUser&amp;rdquo;:&amp;quot;$apiPass&amp;quot; &lt;a href=&#34;https://jss.company.com:8443/JSSResource/osxconfigurationprofiles&#34;&gt;https://jss.company.com:8443/JSSResource/osxconfigurationprofiles&lt;/a&gt; -X GET&lt;/p&gt;</description>
    </item>
    <item>
      <title>New Folder in List View</title>
      <link>http://localhost:1313/posts/new-folder-in-list-view-comments/</link>
      <pubDate>Mon, 26 Mar 2018 13:07:22 +0000</pubDate>
      <guid>http://localhost:1313/posts/new-folder-in-list-view-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;%22anthonymolina62@yahoo.com%22&#34;&gt;Anthony&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;May 3, 2020&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;Found your page on a web search. Exactly what I was looking for, it&amp;rsquo;s awesome. Thank you !&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;&#xA;&lt;p&gt;Hey thanks for this. Works like a charm! Why Apple does not have something like this built-in is beyond me.&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;&#xA;&lt;p&gt;This is soooooooooo helpful! Thanx&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;</description>
    </item>
    <item>
      <title>New Folder in List View</title>
      <link>http://localhost:1313/posts/new-folder-in-list-view/</link>
      <pubDate>Mon, 26 Mar 2018 13:07:22 +0000</pubDate>
      <guid>http://localhost:1313/posts/new-folder-in-list-view/</guid>
      <description>&lt;p&gt;I often use List View in the Finder for the directory where I organize all my packages.  There doesn&amp;rsquo;t seem to be any way to create a folder within the highlighted folder below.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2018/03/screen-shot-2018-03-23-at-4-48-33-pm.png&#34; alt=&#34;Screen Shot 2018-03-23 at 4.48.33 PM.png&#34;&gt; In this post I will show how we can create that option.  Right-click/Control-click doesn&amp;rsquo;t have a New Folder option in this view.  The File menu/Action menu/keyboard shortcut for New Folder makes a the new folder in the folder that is at the root of the window.  That doesn&amp;rsquo;t work for me since there are so many folders in this directory that I lose my place. We can use AppleScript to make a new folder and Automator to make it a Service that will be available in the right-click menu.  Open Automator and choose to make a New Document and Choose to make it a Service.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2018/03/screen-shot-2018-03-23-at-4-56-03-pm.png&#34; alt=&#34;Screen Shot 2018-03-23 at 4.56.03 PM.png&#34;&gt; Then search on the left for Run.  Drag a Run AppleScript action into the workflow on the right.  Then change the dropdowns to &amp;ldquo;Service receives selected folders in Finder&amp;rdquo;&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2018/03/screen-shot-2018-03-23-at-4-58-57-pm.png&#34; alt=&#34;Screen Shot 2018-03-23 at 4.58.57 PM.png&#34;&gt; The AppleScript block will be passed the folder we have selected in the Finder as &lt;code&gt;input&lt;/code&gt;.  We can use that to know where to make our new folder.  We could just use:&lt;code&gt;tell application &amp;quot;Finder&amp;quot; make new folder at input end tell&lt;/code&gt;to make a new folder, but then we have to rename it.  Since we are already using AppleScript, I decided to prompt for the name up front.  So my final AppleScript looks like```&#xA;on run {input, parameters}&#xA;set folderNameDialog to display dialog &amp;ldquo;Enter the folder name:&amp;rdquo; default answer &amp;quot;&amp;quot; buttons {&amp;ldquo;OK&amp;rdquo;} default button &amp;ldquo;OK&amp;rdquo;&#xA;set folderName to text returned of folderNameDialog&#xA;tell application &amp;ldquo;Finder&amp;rdquo;&#xA;make new folder at input with properties {name:folderName}&#xA;end tell&#xA;return input&#xA;end run&lt;/p&gt;</description>
    </item>
    <item>
      <title>Setting the Screen Saver to a static image</title>
      <link>http://localhost:1313/posts/setting-the-screen-saver-to-a-static-image/</link>
      <pubDate>Fri, 02 Feb 2018 20:28:49 +0000</pubDate>
      <guid>http://localhost:1313/posts/setting-the-screen-saver-to-a-static-image/</guid>
      <description>&lt;p&gt;On our Windows systems we have a static image as our screen saver and I wanted to match that on our Macs.  There are several options in the Screen Saver settings of System Preferences.  I needed to figure out how to set a default across all our Macs with a script.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2018/02/screen-shot-2018-02-02-at-1-55-51-pm.png&#34; alt=&#34;Screen Shot 2018-02-02 at 1.55.51 PM.png&#34;&gt;  We wanted a single image statically on the screen.  By making a folder with one image in it, we can use the slideshow options to show our single image. After setting things up the way I wanted, I looked around to see where the settings were stored.  You can use something like &lt;a href=&#34;https://fsmonitor.com&#34;&gt;FSMonitor&lt;/a&gt; to watch what files are edited when you change things in System Preferences.  These settings are per user and per device, so they end up in ~/Library/ByHost/com.apple.screensaver.plist, ~/Library/ByHost/com.apple.ScreenSaver.iLifeSlideShows.plist, and ~/Library/ByHost/com.apple.ScreenSaverPhotoChooser.plist.  If you select other options, you might not need all of these files. To work with this files, use &lt;code&gt;defaults -currentHost read [preference-domain]&lt;/code&gt;. First look at com.apple.screensaver.plist:&lt;code&gt;$ defaults -currentHost read com.apple.screensaver { PrefsVersion = 100; idleTime = 1800; moduleDict =     { moduleName = iLifeSlideshows; path = &amp;quot;/System/Library/Frameworks/ScreenSaver.framework/Resources/iLifeSlideshows.saver&amp;quot;; type = 0; }; }&lt;/code&gt;Then ~/Library/ByHost/com.apple.ScreenSaver.iLifeSlideShows.plist:&lt;code&gt;defaults -currentHost read com.apple.ScreenSaver.iLifeSlideShows { styleKey = Classic; }&lt;/code&gt;Then finally, ~/Library/ByHost/com.apple.ScreenSaverPhotoChooser.plist:&lt;code&gt;defaults -currentHost read com.apple.ScreenSaverPhotoChooser { CustomFolderDict =     { identifier = &amp;quot;/Library/Screen Savers/CompanyName&amp;quot;; name = CompanyName; }; LastViewedPhotoPath = &amp;quot;&amp;quot;; SelectedFolderPath = &amp;quot;/Library/Screen Savers/CompanyName&amp;quot;; SelectedSource = 4; }&lt;/code&gt;To set these, we use a very similar command: &lt;code&gt;defaults -currentHost write [preference-domain] [key] [value]&lt;/code&gt;. After some testing I&amp;rsquo;ve found we just need:```&#xA;#!/bin/sh&#xA;defaults -currentHost write com.apple.screensaver moduleDict -dict moduleName iLifeSlideshows path &amp;ldquo;/System/Library/Frameworks/ScreenSaver.framework/Resources/iLifeSlideshows.saver&amp;rdquo; type 0&#xA;defaults -currentHost write com.apple.ScreenSaver.iLifeSlideShows styleKey Classic&#xA;defaults -currentHost write com.apple.ScreenSaverPhotoChooser SelectedFolderPath &amp;ldquo;/Library/Screen Savers/CompanyName&amp;rdquo;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Automator application to run script as root</title>
      <link>http://localhost:1313/posts/automator-application-to-run-script-as-root-comments/</link>
      <pubDate>Tue, 12 Dec 2017 15:36:31 +0000</pubDate>
      <guid>http://localhost:1313/posts/automator-application-to-run-script-as-root-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;http://rayleighwickfordlabour.org.uk&#34; title=&#34;n.martin@rayleighwickfordlabour.org.uk&#34;&gt;n.martin&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Dec 2, 2017&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;Heyas - it looks like you might be using Jamf from the last screenshot (jamfhelper?). If you&amp;rsquo;re running Jamf Pro 10, you could put the installer policy in Self Service and get a URL that opens Self Service and runs that policy automatically: &lt;a href=&#34;http://docs.jamf.com/10.0.0/jamf-pro/administrator-guide/Making&#34;&gt;http://docs.jamf.com/10.0.0/jamf-pro/administrator-guide/Making&lt;/a&gt;_Items_Available_to_Users_in_Jamf_Self_Service_for_macOS.html There&amp;rsquo;s a section on that page; Item URLs An AppleScript with: do shell script &amp;ldquo;open &amp;quot; might work (haven&amp;rsquo;t tested but would be really interested).&lt;/p&gt;</description>
    </item>
    <item>
      <title>Automator application to run script as root</title>
      <link>http://localhost:1313/posts/automator-application-to-run-script-as-root/</link>
      <pubDate>Tue, 12 Dec 2017 15:36:31 +0000</pubDate>
      <guid>http://localhost:1313/posts/automator-application-to-run-script-as-root/</guid>
      <description>&lt;p&gt;I was recently asked to create a shortcut on our users&amp;rsquo; Desktops to kick off the High Sierra install. We are caching the installer through our management system. In the past I have created a shortcut to the installer on their Desktop, but that required them to click through the many continue buttons. This method will use the startosinstall script from &lt;a href=&#34;https://github.com/bp88/JSS-Scripts/blob/master/OS_Upgrade.sh&#34;&gt;Slack member @bp&lt;/a&gt; to start the install with minimal user interaction. I wrap that shell script (with the appropriate modifications for my environment) in an Automator application, but to have the script run as root, I call it with Run AppleScript using the &lt;code&gt;do shell script ... with administrator privileges&lt;/code&gt; form. &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2017/12/automatorinstaller.png&#34; alt=&#34;AutomatorInstaller.png&#34;&gt; The full AppleScript is&lt;/p&gt;</description>
    </item>
    <item>
      <title>Using installer choices.xml to modify AnyConnect and McAfee deployments</title>
      <link>http://localhost:1313/posts/using-installer-choices-xml-to-modify-anyconnect-and-mcafee-deployments-comments/</link>
      <pubDate>Thu, 27 Jul 2017 01:37:58 +0000</pubDate>
      <guid>http://localhost:1313/posts/using-installer-choices-xml-to-modify-anyconnect-and-mcafee-deployments-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;http://www.rogers.com&#34; title=&#34;scott.beach@rci.rogers.com&#34;&gt;Scott Beach&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Oct 3, 2018&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;I&amp;rsquo;ve been looking for this information for exactly these two .pkgs! This is great. Thank very much for it. I&amp;rsquo;ll work on it tomorrow! - Scott Rogers Communications MacAnalyst&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;&#xA;&lt;p&gt;[…] showing how to deploy Cisco AnyConnect using Jamf Pro. As part of that documentation, HCS described how to create an installer choices XML file and then use it to create a custom Cisco AnyConnect installer […]&lt;/p&gt;</description>
    </item>
    <item>
      <title>Using installer choices.xml to modify AnyConnect and McAfee deployments</title>
      <link>http://localhost:1313/posts/using-installer-choices-xml-to-modify-anyconnect-and-mcafee-deployments/</link>
      <pubDate>Thu, 27 Jul 2017 01:37:58 +0000</pubDate>
      <guid>http://localhost:1313/posts/using-installer-choices-xml-to-modify-anyconnect-and-mcafee-deployments/</guid>
      <description>&lt;p&gt;[edit] I have written a follow up article explaining how to wrap a vendor package and custom choices.xml in a &lt;a href=&#34;https://sneakypockets.wordpress.com/2020/03/17/creating-a-wrapper-package-for-a-choices-xml-file/&#34;&gt;wrapper package&lt;/a&gt;.[/edit] I have seen several posts on &lt;a href=&#34;https://macadmins.herokuapp.com&#34;&gt;MacAdmin Slack&lt;/a&gt; asking for help deploying only components of big packages that the business wants or needs.  There are often several ways of handling this.  For example, from the McAfee ePO console, your admin can give you a Threat Prevention only installer instead of the full Endpoint Security package.  That is great if you can grab that yourself or the admin is helpful and able to get it for you.  This isn&amp;rsquo;t always the case.  Another route is to install the full package and then uninstall the pieces that you don&amp;rsquo;t want/need.  The Cisco AnyConnect Secure Mobility client installer does put uninstall scripts for each piece of the package in /opt/cisco/anyconnect/bin.  Both of these options can get your Macs to the end state you want, but they do have potential drawbacks/complications.  Using the Apple provided installer command line tool, we can see what options are available in these packages and then create a file to set which pieces we want.  This does take some work upfront, but we have all the tools we need.   To start we need an installer package that has choices.  We will focus on 2, Cisco&amp;rsquo;s AnyConnect Secure Mobility Client 4.3.03086 and McAfee&amp;rsquo;s Endpoint Security for Mac 10.2.1.  The choices show up in the GUI as selectable check boxes. [gallery ids=&amp;ldquo;593,592&amp;rdquo; type=&amp;ldquo;rectangular&amp;rdquo;] To see these choices from the command line and generate the information we need, we use the installer command with the &lt;code&gt;‑showChoicesXML&lt;/code&gt; option and pass it the package we are interested in.  Depending on the package, we may also need to specify the target, so I generally always do.  Be careful with the target.  Some installers will behave differently if some or all of the software is already installed. Installing on a clean system (maybe a VM you can role back) is a good way to see the real default behavior. Notice in the Cisco installer picture above, VPN and WebSecurity are unchecked and grayed out.  That is because my target already has those pieces installed on it. Our command is: &lt;code&gt;installer ‑showChoicesXML ‑pkg /path/to/AnyConnect.pkg ‑target /&lt;/code&gt; That will print a bunch of information to standard out (the terminal window), so I will often redirect it to a file for saving and easier reading/searching like so: &lt;code&gt;installer ‑showChoicesXML ‑pkg /path/to/AnyConnect.pkg ‑target / &amp;gt; ~/Desktop/anyconnect_choices.xml&lt;/code&gt; That will output something like:[gist]542c05e12abb931746cc9811e60fe32d[/gist] Notice the individual dictionaries:[gist]14ad94a01a22cb98a5de9f6f36448247[/gist] This is one of the choices in the package (Umbrella).  Notice that the choiceIsSelected key is set to 1.  This means that by default on this volume (the target from the command), this choice will be installed.  We want to tell the installer command to skip this choice so we want to set choiceIsSelected to 0.  To do that we will create our own xml file that has the values we want.  The keys that we need are the choiceIdentifier, choiceIsSelected, and whether we want the choice to install (set value to 1) or not install (set value to 0).  Our file needs to be valid XML, so we need the appropriate file header.  You can create a valid XML file with the built in defaults command but for this, we can just copy the skeleton of our choices.xml we output from installer.[gist]c7002bd6dba90b136ff48b7a5a3b08eb[/gist] Now we need to add a dictionary for each setting we want to set in this form:[gist]e157915f4e47ce2583eaea71b682cd6d[/gist] We need to match the choiceIdentifier values to the those in the output of the installer command.  This AnyConnect package is setup nicely for easy reading.  Not all packages are (more on that later).  Then we have our choiceAttribute key (the key we want to change from default) set to &amp;lsquo;selected&amp;rsquo; and finally what we want to set that attribute to in the attributeSetting key (in this case we are setting it to 0 so this choice doesn&amp;rsquo;t install). We only need to add entries for things we want to change from the default. In this case the choices file specifies settings for all possible choices. Once we build up our file, we get something like:[gist]8a34f3b7741de31e969e09247b3c31d9[/gist] This file tells &lt;code&gt;installer&lt;/code&gt; to install VPN and skip the rest. Now we are ready to test the package.  To first verify that things look like they will work, we can use the &lt;code&gt;‑showChoicesAfterApplyingChangesXML&lt;/code&gt; option for installer and see what it will try to do. &lt;code&gt;installer ‑showChoicesAfterApplyingChangesXML /path/to/choicesForAnyConnect.xml ‑pkg /path/to/AnyConnect.pkg ‑target /&lt;/code&gt; [gist]9f62ad9b678d20181f6365099c94169c[/gist]In this output we will see more than one entry for each choice.  In this output I have 3, enabled, visible, and selected.  Enabled means will the choice be allowed to be changed in the GUI and visible means will it even show up in the GUI.  We are only worried about selected as we aren&amp;rsquo;t going to use the GUI.  So confirm that the choices we want to install have selected set to 1 and the choices we want to skip have selected set to 0. Once that all looks correct, we can actually deploy with &lt;code&gt;‑applyChoiceChangesXML&lt;/code&gt;.  That looks like &lt;code&gt;installer ‑applyChoiceChangesXML /path/to/choicesForAnyConnect.xml ‑pkg /path/to/AnyConnect.pkg ‑target /&lt;/code&gt; This can be packaged up for deployment through a management tool pretty easily.  Basically you want to put the default package and your choices.xml into the packages resources area and then have a post install script that runs the above command.  There is a lot more detail possible, but that might be another blog post. Cisco&amp;rsquo;s AnyConnect Secure Mobility installer is pretty friendly when it comes to repackaging/making choices.  If we try to apply the above to the McAfee Endpoint Security 10.2.1 installer, we will see some additional complexity. &lt;code&gt;installer ‑showChoicesXML ‑pkg /path/to/McAfee_Endpoint_Security\ 10.2.1/1\ Source/McAfee-Endpoint-Security-for-Mac-10.2.1-RTW-standalone-2632.pkg ‑target /&lt;/code&gt; [gist]6c976037049b701741deb01bce7c660d[/gist] Notice that the choiceIdentifier is the not so helpful installer_choice_5.  We can still see what the choice is by the choiceTitle, but now when we create our choices.xml, we need to be very careful about which choices we are selecting and which we are not.  Your end result will look something like: [gist]c4cb8ef55ce6e11b108fa6a51e48c385[/gist] In this file, installer_choice_5 is the Firewall and installer_choice_6 is Web Control. For this type of package it can be important to save the output of showChoicesXML as a reference for which choice is which. This is an example of only putting in dictionaries for the choices we want to change.  I would say this is probably not a best practice as different systems can end up with different defaults, but it can work.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Signing Installer Packages with Automator</title>
      <link>http://localhost:1313/posts/signing-installer-packages-with-automator-comments/</link>
      <pubDate>Sat, 05 Nov 2016 01:51:33 +0000</pubDate>
      <guid>http://localhost:1313/posts/signing-installer-packages-with-automator-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;%22developers@buildtestrun.com%22&#34;&gt;mbonne&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Apr 5, 2019&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;+1 automation services levelled up&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;&#xA;&lt;p&gt;[…] is created, drag it to the Post-installation well, save your package, and build it. I then sign my packages with a certificate from my company’s Apple developer […]&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;</description>
    </item>
    <item>
      <title>Signing Installer Packages with Automator</title>
      <link>http://localhost:1313/posts/signing-installer-packages-with-automator/</link>
      <pubDate>Sat, 05 Nov 2016 01:51:33 +0000</pubDate>
      <guid>http://localhost:1313/posts/signing-installer-packages-with-automator/</guid>
      <description>&lt;p&gt;Apple packages (.pkgs) are opened by the GUI Installer.app or the command line installer command. If a package is unsigned and gets a quarantine flag (from being transferred over a network), the GUI Installer will refuse to run it.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-07-35-pm.png&#34; alt=&#34;Screen Shot 2016-11-02 at 3.07.35 PM.png&#34;&gt; We can get around that with a right-click -&amp;gt; Open, but we shouldn&amp;rsquo;t be training computer users to ignore security warnings like this. &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-04-at-4-49-33-pm.png&#34; alt=&#34;Screen Shot 2016-11-04 at 4.49.33 PM.png&#34;&gt; If you are creating your own packages, and users or techs may run them manually, then you really should be signing them. Even if you are deploying them in a way that a person won&amp;rsquo;t see a warning, signing packages can be very easy and provide a check that nothing changed since you created it. See below the break for how to easily automate signing packages. I use &lt;a href=&#34;http://s.sudre.free.fr/Software/Packages/about.html&#34;&gt;WhiteBox Packages&lt;/a&gt; to create most of my packages. It has a built in feature to sign packages it builds, but recent versions have had some problems with it and when it works it still has to be set per package project. The Apple provided tool to sign our packages is &lt;code&gt;productsign&lt;/code&gt;. This works, but to make things easier on myself, I have wrapped that up in an Automator application that I can use as a droplet. The basic format for using productsign is &lt;code&gt;productsign [options] --sign identity input-product-path output-product-path&lt;/code&gt; Interestingly, the man page for productsign doesn&amp;rsquo;t show any available options. So next we want to &lt;code&gt;--sign&lt;/code&gt; using &lt;code&gt;identity&lt;/code&gt;. This is our Developer ID Installer certificate from Apple&amp;rsquo;s developer program. This does require a paid membership, but if you work for an organization supporting Macs, there is plenty of benefit to offset the $99 or $399/year (signing identities, early access to OS builds for testing, etc). To sign packages we need a Developer ID Installer (see &lt;a href=&#34;https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/MaintainingCertificates/MaintainingCertificates.html#//apple_ref/doc/uid/TP40012582-CH31-SW6&#34;&gt;Apple&amp;rsquo;s documentation&lt;/a&gt;) Once you have your Dev ID Installer certificate installed in your keychain, then we can get the appropriate reference for it. Open /Applications/Utilities/Keychain Access. Search for Developer ID and select the appropriate certificate. Then you can highlight and copy the name.  If you are a part of more than one developer program, select the &amp;ldquo;right&amp;rdquo; one here.  You can create several Automator applications if you want to have one for each ID.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-25-14-pm.png&#34; alt=&#34;Screen Shot 2016-11-02 at 3.25.14 PM.png&#34;&gt; So now we can write our command &lt;code&gt;productsign --sign &#39;Developer ID Installer: OrgName (Code)&#39; in_pkg out_pkg&lt;/code&gt;. For example &lt;code&gt;productsign --sign &#39;Developer ID Installer: OrgName (Code)&#39; ~/Development/Unsigned.pkg ~/Development/Signed.pkg&lt;/code&gt;. This will prompt to allow productsign access to your keychain. Say Allow or Always Allow.&lt;code&gt;$ productsign --sign &#39;Developer ID Installer: OrgName (Code)&#39; ~/Desktop/Unsigned/build/Unsigned.pkg ~/Desktop/Unsigned/build/Signed.pkg productsign: using timestamp authority for signature productsign: signing product with identity &amp;quot;Developer ID Installer: OrgName (Code)&amp;quot; from keychain /Users/username/Library/Keychains/login.keychain-db productsign: adding certificate &amp;quot;Developer ID Certification Authority&amp;quot; productsign: adding certificate &amp;quot;Apple Root CA&amp;quot; productsign: Wrote signed product archive to /Users/username/Desktop/Unsigned/build/Signed.pkg&lt;/code&gt;Now when we run the installer by double clicking it, the installer opens. Notice the lock in the upper right corner. Click the clock and we can examine the certificate chain back to Apple&amp;rsquo;s Root.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-29-14-pm1.png&#34; alt=&#34;Screen Shot 2016-11-02 at 3.29.14 PM.png&#34;&gt; The idea when we started was to make this easy to do since we might need to sign a lot of packages over time. To automate this, open /Applications/Automator.app. Choose to create a New Document. Then choose Application for the type and click Choose.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-31-43-pm.png&#34; alt=&#34;Screen Shot 2016-11-02 at 3.31.43 PM.png&#34;&gt; Search for shell in the Actions name search field. Drag a run shell script action to the workflow.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-32-11-pm.png&#34; alt=&#34;Screen Shot 2016-11-02 at 3.32.11 PM.png&#34;&gt; First adjust the Pass input: pop up to as arguments.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-33-00-pm.png&#34; alt=&#34;Screen Shot 2016-11-02 at 3.33.00 PM.png&#34;&gt; That will fill in the template for us. Then enter our productsign command with some slight differences. The &lt;code&gt;--sign&lt;/code&gt; and &lt;code&gt;identity&lt;/code&gt; will be the same, but now for the input and output, we need to make this work with whatever is dropped on the application. The packages will be passed as arguments and the for loop will work on each one in turn. These will be assigned to the pkg variable, so that becomes our input file. Then for the output, I settled on packagename.signed.pkg to differentiate the output from the input. This &lt;code&gt;$(sed &#39;s/.pkg$/.signed.pkg/g&#39; &amp;lt;&amp;lt;&amp;lt; $pkg)&lt;/code&gt; will find the last &amp;lsquo;.pkg&amp;rsquo; in the filename and replace it with &amp;lsquo;.signed.pkg&amp;rsquo;, while keeping the name portion the same (see note at the end for how this works) .  Notice I also changed the &lt;code&gt;f&lt;/code&gt; to &lt;code&gt;pkg&lt;/code&gt; just to make it clear what the variable represents.```&#xA;for pkg in &amp;ldquo;$@&amp;rdquo;&#xA;do&#xA;productsign &amp;ndash;sign &amp;lsquo;Developer ID Installer: OrgName (Code)&amp;rsquo; &amp;ldquo;$pkg&amp;rdquo; &amp;ldquo;$(sed &amp;rsquo;s/.pkg$/.signed.pkg/g&amp;rsquo; &amp;laquo;&amp;lt; $pkg)&amp;rdquo;&#xA;done&lt;/p&gt;</description>
    </item>
    <item>
      <title>Mounting File Shares Based on AD Group Membership using Enterprise Connect</title>
      <link>http://localhost:1313/posts/mounting-file-shares-based-on-ad-group-membership-using-enterprise-connect-comments/</link>
      <pubDate>Mon, 26 Sep 2016 14:27:25 +0000</pubDate>
      <guid>http://localhost:1313/posts/mounting-file-shares-based-on-ad-group-membership-using-enterprise-connect-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;%22brinckmann@bevelo.de%22&#34;&gt;tam&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Jan 3, 2018&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;Setting mount_options and open_options to none under 10.13.3 didtn work for me..but thank you :) Python[50420:162669] -[OC_PythonString objectForKey:]: unrecognized selector sent to instance 0x7fd716e28a80 Traceback (most recent call last): File &amp;ldquo;&amp;rdquo;, line 38, in File &amp;ldquo;&amp;rdquo;, line 30, in mount_share ValueError: NSInvalidArgumentException - -[OC_PythonString objectForKey:]: unrecognized selector sent to instance 0x7fd716e28a80&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;&#xA;&lt;p&gt;hmm&amp;hellip; I guess I ended up doing it a bit differently in production. Does this work for you? def mount_share(share_path): # Mounts a share at /Volumes, returns the mount point or raises an error sh_url = CoreFoundation.CFURLCreateWithString(None, share_path, None) # Set UI to reduced interaction # open_options = {NetFS.kNAUIOptionKey: NetFS.kNAUIOptionNoUI} # Allow mounting sub-directories of root shares # mount_options = {NetFS.kNetFSAllowSubMountsKey: True} # Mount! result, output = NetFS.NetFSMountURLSync(sh_url, None, None, None, None, None, None) # Check if it worked if result != 0: raise Exception(&amp;lsquo;Error mounting url &amp;ldquo;%s&amp;rdquo;: %s&amp;rsquo; % (share_path, output)) # Return the mountpath return str(output[0])&lt;/p&gt;</description>
    </item>
    <item>
      <title>Mounting File Shares Based on AD Group Membership using Enterprise Connect</title>
      <link>http://localhost:1313/posts/mounting-file-shares-based-on-ad-group-membership-using-enterprise-connect/</link>
      <pubDate>Mon, 26 Sep 2016 14:27:25 +0000</pubDate>
      <guid>http://localhost:1313/posts/mounting-file-shares-based-on-ad-group-membership-using-enterprise-connect/</guid>
      <description>&lt;p&gt;[edit] Apple changed something in macOS 10.13 High Sierra. The mount_share() function in the below python needs to be changed to set the open_options and mount_options to &amp;lsquo;None&amp;rsquo;. This can be done like&lt;code&gt;def mount\_share(share\_path): # Mounts a share at /Volumes, returns the mount point or raises an error sh\_url = CoreFoundation.CFURLCreateWithString(None, share\_path, None) # Set UI to reduced interaction #open\_options  = {NetFS.kNAUIOptionKey: NetFS.kNAUIOptionNoUI} # Allow mounting sub-directories of root shares #mount\_options = {NetFS.kNetFSAllowSubMountsKey: True} # Mount! result, output = NetFS.NetFSMountURLSync(sh\_url, None, None, None, None, None, None) # Check if it worked if result != 0: raise Exception(&#39;Error mounting url &amp;quot;%s&amp;quot;: %s&#39; % (share\_path, output)) # Return the mountpath return str(output\[0\])&lt;/code&gt;[/edit] In a &lt;a href=&#34;https://sneakypockets.wordpress.com/2016/09/22/using-ldapsearch-to-get-ad-data/&#34;&gt;previous post&lt;/a&gt;, I discussed using &lt;code&gt;ldapsearch&lt;/code&gt; to look up user data from AD.  In this post we will use the user&amp;rsquo;s memberOf attribute to mount the appropriate file share. Some background on my use case for this.  The company I work for has ~15,000 Windows computers in use bound to AD.  When a user logs in, a GPO runs a batch file hosted on the domain controller&amp;rsquo;s file share.  The batch file is basically a large case statement&lt;code&gt;if in group A; then     mount shares X and Y if in group B; then     mount share Z&lt;/code&gt;I wanted to provide our Mac users with a similar experience.  Read how below the break. Our Macs are not bound to Active Directory and we have historically had password confusion issues with network vs local passwords and keychain sync issues.  To help this we have setup Apple&amp;rsquo;s excellent &lt;a href=&#34;https://jamfnation.jamfsoftware.com/discussion.html?id=17757&#34;&gt;Enterprise Connect&lt;/a&gt; to help with that. When a Mac user is logged in and is on a network that can connect to our domain controllers (internal, VPN, etc), Enterprise Connect automatically retrieves a Kerberos Ticket Granting Ticket for the user and, optionally, confirms that the local password is in sync with the user&amp;rsquo;s AD password and prompts the user to fix things if necessary.  Enterprise Connect can also mount file shares including the user&amp;rsquo;s home folder.  This is handled on a per user basis or by profile.  This works great if the user wants to mount a share they use, but it doesn&amp;rsquo;t scale well across many locations and OUs. One of the other benefits of Enterprise Connect is that it can run scripts based on a couple of triggers including a successful connection (i.e. the Mac is on the right network and a valid TGT has been granted).  Note that Enterprise Connect can only run shell scripts this way. The script to run can be configured in the preference file or via profile with the key/value pair:&lt;code&gt;connectionCompletedScriptPath /Library/Scripts/LogonFileShareMounter.wrapper.sh&lt;/code&gt;This script is stored locally on the client system and is what calls the script that will do the actual mounting.  Before that though, we first make sure that we have the current version of the mounting script by checking an embedded serial number (similar to how DNS primary/secondaries work).  The master copy of the mounting script is hosted on the same share as the Windows batch file.  This way it can be updated whenever the Windows version is.  As long as the serial number is updated, the Mac clients will get the updated version next time they successfully connect with Enterprise Connect. &lt;a href=&#34;https://gist.github.com/ehemmete/618c96dc364d8a40723e30692617d2a8&#34;&gt;https://gist.github.com/ehemmete/618c96dc364d8a40723e30692617d2a8&lt;/a&gt; The script starts by creating a directory if necessary and then mounting the file share where the master script is kept.  The &lt;code&gt;mount_smbfs&lt;/code&gt; line authenticates to the share with the Kerberos TGT  from Enterprise Connect.  Then as long as the master script can be found, the local serial is compared to the remote version.  If the remote is newer, it is copied in place of the local copy.  Then the share is unmounted and the local copy of the script is run. &lt;a href=&#34;https://gist.github.com/ehemmete/2f893815bd03d96d89855feb4e9b7237&#34;&gt;https://gist.github.com/ehemmete/2f893815bd03d96d89855feb4e9b7237&lt;/a&gt; This script starts with the serial number that is compared against the master copy.  Then the part between the ### lines comes straight from MacAdmin Slack member and frequent gist&amp;rsquo;er Froger/pudquick/MikeyMikey.  His &lt;a href=&#34;https://gist.github.com/pudquick/1362a8908be01e23041d&#34;&gt;gist&lt;/a&gt; is referenced in the script and provides a python function for mounting network shares easily and in such as way that the system treats them the same as the Connect to Server dialog box. Then we get the user&amp;rsquo;s local account name, which in my environment is the same as their Active Directory name, and use &lt;code&gt;ldapsearch&lt;/code&gt; to find their group memberships.  Next we need to clean up the output.  At the end we have an array of names of the groups this user is a member of.  Now we start a case-like statement similar to the Window counter part.```&#xA;if &amp;lsquo;Group1&amp;rsquo; in groups:&#xA;mount_share(&amp;lsquo;smb://server.my.domain.com/share&amp;rsquo;)&#xA;mount_share(&amp;lsquo;smb://server2.my.domain.com/share2&amp;rsquo;)&#xA;if &amp;lsquo;Group2&amp;rsquo; in groups:&#xA;mount_share(&amp;lsquo;smb://server3.my.domain.com/share&amp;rsquo;)&#xA;etc&amp;hellip;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Using ldapsearch to get AD data</title>
      <link>http://localhost:1313/posts/using-ldapsearch-to-get-ad-data-comments/</link>
      <pubDate>Thu, 22 Sep 2016 17:31:02 +0000</pubDate>
      <guid>http://localhost:1313/posts/using-ldapsearch-to-get-ad-data-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://sneakypockets.wordpress.com/2016/09/26/mounting-file-shares-based-on-ad-group-membership-using-enterprise-connect/&#34; title=&#34;&#34;&gt;Mounting File Shares Based on AD Group Membership using Enterprise Connect | My Thoughts&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Sep 1, 2016&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;[…] a previous post, I discussed using ldapsearch to look up user data from AD.  In this post we will use the […]&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;</description>
    </item>
    <item>
      <title>Using ldapsearch to get AD data</title>
      <link>http://localhost:1313/posts/using-ldapsearch-to-get-ad-data/</link>
      <pubDate>Thu, 22 Sep 2016 17:31:02 +0000</pubDate>
      <guid>http://localhost:1313/posts/using-ldapsearch-to-get-ad-data/</guid>
      <description>&lt;p&gt;It has been common for Macs to be bound to Active Directory for a variety of reasons.  Recently, the trend has been to move away from binding due to password/lock out issues, the rise of cloud based services, and SSO options that are more comprehensive of the services users need. With the move away from binding, one thing we lose is the ability to look up user and group data with &lt;code&gt;dscl&lt;/code&gt;. Here is a decent primer on &lt;code&gt;dscl&lt;/code&gt;: http://www.macos.utah.edu/documentation/authentication/dscl.html (just replace every instance of netinfo with dslocal in your mind). With this move we need another tool to query for information and &lt;code&gt;ldapsearch&lt;/code&gt; can do this for us.  There are a lot of ways to use &lt;code&gt;ldapsearch&lt;/code&gt; depending on your end goal.  This post will discuss getting user data out of an Active Directory server.  In a future post I hope to explain how I am using this to mount the appropriate file shares for users based on their group membership. The basic format for ldapsearch is to tell it where to search, with what account to search, what to search for, and what data to return from any matches.  A common search I use is:&lt;code&gt;ldapsearch -LLL -H &amp;quot;ldap://${adURL}&amp;quot; -b &amp;quot;${searchbase}&amp;quot; &amp;quot;(&amp;amp;(objectCategory=Person)(objectClass=User)(sAMAccountName=$endUser))&amp;quot; memberOf&lt;/code&gt;We start with the command, of course.  Then the &lt;code&gt;-LLL&lt;/code&gt; tells the command to limit the output.  I find this gives less output to clean out before I get what I want.  The man page says:&lt;code&gt;**\-L**     Search  results  are  display in LDAP Data Interchange Format detailed in **ldif**(5).  A single **\-L** restricts the output to LDIFv1. A second **\-L** disables comments.  A third **\-L** disables printing of the LDIF version.  The defaultis to use an extended version of LDIF.&lt;/code&gt;Then we need to tell ldapsearch where to search.  There are a few parts to this.  The first is the &lt;code&gt;-H&lt;/code&gt; option with an ldapuri which will often be the DNS name of the domain controller you want to search on in the form &amp;ldquo;ldap://my.domain.com&amp;rdquo;.  (This can generally be found with &lt;code&gt;host -t SRV _ldap._tcp.my.domain.com&lt;/code&gt;).  If you have multiple DCs, you can search more than one, but I normally pick a close one to search.  Then &lt;code&gt;-b&lt;/code&gt; specifies the search base to start the search from.  I use the root of the LDAP structure, but if you know where your data is going to be you can be more specific.  This will be in the form &lt;code&gt;&amp;quot;dc=my,dc=domain,dc=com&amp;quot;&lt;/code&gt; or &lt;code&gt;&amp;quot;OU=Computers,dc=my,dc=domain,dc=com&amp;quot;&lt;/code&gt;. Next we need to tell ldapsearch who to search as.  In my command above, I don&amp;rsquo;t make it explicit, but the default is to check for a kerberos ticket granting ticket and use that for authentication.  This works nicely for scripting since there is no password to worry about, but you do need to be sure there will be a TGT when the script/command runs.  Another form of ldapsearch command would be:&lt;code&gt;ldapsearch -LLL -x -H &amp;quot;ldaps://$adURL&amp;quot; -D &amp;quot;${techNameTest}@my.domain.com&amp;quot; -w &amp;quot;$techPW&amp;quot; -b &amp;quot;${searchbase}&amp;quot; &amp;quot;(&amp;amp;(objectCategory=Person)(objectClass=User)(sAMAccountName=$endUser))&amp;quot; memberOf&lt;/code&gt;In this search we first tell ldapsearch to use simple (username/password) authentication with the &lt;code&gt;-x&lt;/code&gt; option.  Then specify who to search as with &lt;code&gt;-D&lt;/code&gt; and the full form should be &lt;code&gt;&amp;quot;user@domain&amp;quot;&lt;/code&gt; or &lt;code&gt;&amp;quot;domain\user&amp;quot;&lt;/code&gt;.  Then the &lt;code&gt;-w&lt;/code&gt; is used to put the password inline with the command.  If there are special characters in the password be sure to wrap it in single quotes; &lt;code&gt;&#39;pa$$W0rd!&#39;&lt;/code&gt;.  For one off searches, you can use &lt;code&gt;-W&lt;/code&gt; to have the command prompt for the password.  &lt;strong&gt;Also note,when using password base authentication, we should really use ldaps:// in the &lt;code&gt;-H&lt;/code&gt; option.  Otherwise the password will be sent across the network in the clear.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/09/screen-shot-2016-09-22-at-10-46-17-am1.png&#34; alt=&#34;Screen Shot 2016-09-22 at 10.46.17 AM.png&#34;&gt;With kerberos authentication the password is not sent across the network at all.&lt;/strong&gt; Next we specify what to search for.  In this case I am searching for a user&amp;rsquo;s account, but it could be in many different locations.  We can string filters together using the &amp;ldquo;(&amp;amp;(filter)(filter)(filter)&amp;hellip;)&amp;rdquo; format.  The filters can include a wide range of things.  I am limiting the search based on &lt;code&gt;objectCategory=Person&lt;/code&gt;, &lt;code&gt;objectClass=User&lt;/code&gt;, and &lt;code&gt;sAMAccountName=first.last&lt;/code&gt;.  It turns out I can get away with just using the sAMAccountName if I know exactly who I am looking for.  If we only need one filter, we can use the form &amp;ldquo;(filter)&amp;rdquo;, i.e. &lt;code&gt;&amp;quot;(sAMAccountName=first.last)&amp;quot;&lt;/code&gt;. Lastly we tell &lt;code&gt;ldapsearch&lt;/code&gt; what data we want back.  This is optional if you want the entire record, but if we just need one piece it is very useful to get that one thing returned.  In this case I am requesting just the &lt;code&gt;memberOf&lt;/code&gt; values from the account.  This will tell me the groups this user is a member of. If we put this all together we can get something like this (note you can limit the output further with &lt;code&gt;2&amp;gt;/dev/null&lt;/code&gt; , which will redirect the authentication messages which are sent to stderr): [code language=&amp;ldquo;bash&amp;rdquo;]$ldapsearch -LLL -H &amp;ldquo;ldap://dc.my.domain.com&amp;rdquo; -b &amp;ldquo;dc=my,dc=domain,dc=com&amp;rdquo; &amp;ldquo;(sAMAccountName=last)&amp;rdquo; memberOf SASL/GSSAPI authentication started SASL username: &lt;a href=&#34;mailto:tech.id@MY.DOMAIN.COM&#34;&gt;tech.id@MY.DOMAIN.COM&lt;/a&gt; SASL SSF: 112 SASL data security layer installed. dn: CN=Tech.ID,OU=CO,OU=Users,OU=US,DC=MY,DC=DOMAIN,DC=com memberOf: CN=AM IT Infrastructure Group,OU=Distribution Lists,OU=Exchange,OU=US,DC=MY,DC=DOMAIN,DC=COM memberOf: CN=AM AON IT,OU=Distribution Lists,OU=Exchange,OU=US,DC=MY,DC=DOMAIN,DC=COM memberOf: CN=WebReports_ReadOnly,OU=Groups,OU=US,DC=MY,DC=DOMAIN,DC=COM memberOf: CN=IT - MaaS360 AM Compliance Block,OU=Distribution Lists,OU=Exchange,OU=US,DC=MY,DC=DOMAIN,DC=COM memberOf: CN=AM MFA VPN,OU=Distribution Lists,OU=Exchange,OU=US,DC=MY,DC=DOMAIN,DC=COM memberOf: CN=Configuration Management,OU=Distribution Lists,OU=Exchange,OU=US,DC=MY,DC=DOMAIN,DC=COM memberOf: CN=IT - Lync Users in AM,OU=Distribution Lists,OU=Exchange,OU=US,DC=AM,DC=DOMAIN,DC=COM memberOf: CN=IT - Cisco usCUCMCluster02 Users,OU=Distribution Lists,OU=Exchange,OU=US,DC=MY,DC=DOMAIN,DC=COM memberOf: CN=L\#Contractor,OU=Groups,OU=US,DC=MY,DC=DOMAIN,DC=COM memberOf: CN=SCCDUsers-AM,OU=Global,DC=MY,DC=DOMAIN,DC=COM memberOf: CN=IT - Exchange 365 Users in AM,OU=Distribution Lists,OU=Exchange,OU=US,DC=MY,DC=DOMAIN,DC=COM memberOf: CN=AON IT Contractors (US),OU=Distribution Lists,OU=Exchange,OU=US,DC=AM,DC=DOMAIN,DC=COM memberOf: CN=Americas IT Consultants,OU=Distribution Lists,OU=Exchange,OU=US,DC=AM,DC=DOMAIN,DC=COM # refldap://DomainDnsZones.AM.DOMAIN.com/DC=DomainDnsZones,DC=MY,DC=DOMAIN,DC=com [/code]&lt;/p&gt;</description>
    </item>
    <item>
      <title>macOS Sierra Recovery HD Changes</title>
      <link>http://localhost:1313/posts/macos-sierra-recovery-hd-changes-comments/</link>
      <pubDate>Wed, 21 Sep 2016 20:41:40 +0000</pubDate>
      <guid>http://localhost:1313/posts/macos-sierra-recovery-hd-changes-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://ExtremeLanding.com/&#34; title=&#34;ExtremeLanding.com@gmail.com&#34;&gt;Extreme Landing&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Jan 2, 2017&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;I accidentally changed the ACLs permissions on my home folder and had the same problem on my MacBook Pro running macOS Sierra version 10.12.2 Follow the step below to changed the folders No Access permissions and revert back to Allow access: Restart with the Command and S keys held down, and run the following commands: mount -uw / chown root / chmod 1775 / exit &amp;ndash; After the last command &amp;ldquo;exit&amp;rdquo; your system should restart on its own and everything should appear the same as the time before you changed the Home folder permissions. I hope this helps, Extreme Landing &lt;a href=&#34;https://ExtremeLanding.com/&#34;&gt;https://ExtremeLanding.com/&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>macOS Sierra Recovery HD Changes</title>
      <link>http://localhost:1313/posts/macos-sierra-recovery-hd-changes/</link>
      <pubDate>Wed, 21 Sep 2016 20:41:40 +0000</pubDate>
      <guid>http://localhost:1313/posts/macos-sierra-recovery-hd-changes/</guid>
      <description>&lt;p&gt;[Update 7/20/17] As of 10.12.6 RepairHomePermissions still fails with error: Unable to launch the underlying task process.  Also my bug report has been marked as a  DUPLICATE OF 25393689. [Update 1/26/17] As of 10.12.3 RepairHomePermissions still fails with error: Unable to launch the underlying task process. One of the areas that hasn&amp;rsquo;t gotten much coverage with the update to Sierra is the Recovery HD. This is the minimal OS environment that lets us do things like reinstall the OS, restore a Time Machine backup, and partition volumes before an install. The other thing that Recovery allows us to do is to reset forgotten passwords. Originally, we could do this by booting off the install CD/DVD. Once those went away Recovery HD gave us a Reset Password option in the Utilities menu. That went away in Yosemite(?) but we could get the same functionality by choosing Utilities -&amp;gt; Terminal and running the resetpassword command. This reset password utility would also allow us to reset a users home folder permissions, including the default ACLs. Now with macOS Sierra v10.12, this has changed again. To start, boot to Recovery by holding down Command-R at startup.  You will end up at a screen like: &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/09/screen-shot-2016-09-21-at-3-10-31-pm.png&#34; alt=&#34;Screen Shot 2016-09-21 at 3.10.31 PM.png&#34;&gt; Then open the Utilities menu and choose Terminal:&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/09/screen-shot-2016-09-21-at-3-10-55-pm.png&#34; alt=&#34;Screen Shot 2016-09-21 at 3.10.55 PM.png&#34;&gt; In the Terminal window that open, run the resetpassword command to bring up a new assistant.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/09/screen-shot-2016-09-21-at-3-11-11-pm.png&#34; alt=&#34;Screen Shot 2016-09-21 at 3.11.11 PM.png&#34;&gt; Select the user you need to reset the password of and click Next. &lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/09/screen-shot-2016-09-21-at-3-11-28-pm.png&#34; alt=&#34;Screen Shot 2016-09-21 at 3.11.28 PM.png&#34;&gt; Then you can enter the new password and confirm it.  Add a hint if you want and click Next.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/09/screen-shot-2016-09-21-at-3-11-42-pm.png&#34; alt=&#34;Screen Shot 2016-09-21 at 3.11.42 PM.png&#34;&gt; Finally you get confirmation of the change and can reboot.  Or if you open the Reset Password menu, you can quit to easily return to the Terminal.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/09/screen-shot-2016-09-21-at-3-11-57-pm.png&#34; alt=&#34;Screen Shot 2016-09-21 at 3.11.57 PM.png&#34;&gt; The piece that is missing from all that is reseting home folder permissions.  It turns out there is a new tool to (try to) do this.  Back in your terminal, enter the command RepairHomePermissions and hit Enter.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/09/screen-shot-2016-09-21-at-3-12-28-pm.png&#34; alt=&#34;Screen Shot 2016-09-21 at 3.12.28 PM.png&#34;&gt; Again an assistant opens and we can select the user whose home folder permissions we need to reset.  Click Next.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/09/screen-shot-2016-09-21-at-3-12-36-pm.png&#34; alt=&#34;Screen Shot 2016-09-21 at 3.12.36 PM.png&#34;&gt; Unfortunately, at this time (Sierra v10.12 build 16A323) the process fails.&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2016/09/screen-shot-2016-09-21-at-3-12-41-pm.png&#34; alt=&#34;Screen Shot 2016-09-21 at 3.12.41 PM.png&#34;&gt; Again, you can reboot or Quit the RepairHomePermissions assistant (interestingly called ResetPassword in the menu bar). Note that RepairHomePermissions is available in a full Sierra install, but fails even sooner when run as it tries to reference /System/Installation/CDIS/KeyRecoveryAssistant.app/Contents/MacOS/KeyRecoveryAssistant, which doesn&amp;rsquo;t exist on a standard install. Also both of these assistants will have you unlock a FileVaulted drive before asking you which user to work with. Thanks to MacAdmin Slack members mikethefifth, for asking about reseting home folder permissions which prompted these tests, and owen.pragel, for sharing the new command list that included the tantalizing RepairHomePermissions and for finding the reference to KeyRecoveryAssistant. Update: I have filed a bug about RepairHomePermissions not working. https://openradar.appspot.com/28431470&lt;/p&gt;</description>
    </item>
    <item>
      <title>Capturing information while running Casper Imaging</title>
      <link>http://localhost:1313/posts/capturing-information-while-running-casper-imaging/</link>
      <pubDate>Fri, 06 May 2016 20:09:40 +0000</pubDate>
      <guid>http://localhost:1313/posts/capturing-information-while-running-casper-imaging/</guid>
      <description>&lt;p&gt;I recently changed jobs and am now managing a JAMF Casper suite that really hadn&amp;rsquo;t had much done to it before. Previous imaging was done via a monolithic image with Clonezilla and a lot of hand configuration. The Windows environment here is much more mature and one of the things that is done on the Windows side is to capture information about the build as it happens. This post is about replicating that on the Macs when using Casper Imaging. Sidenote: I hope to move to DEP soon and stop most of the imaging that happens here, but until then&amp;hellip; Our basic workflow is to boot from a flash drive created from an AutoCasperNBI image. From there Casper Imaging launches, is configured, and the process starts. The first thing in our configuration is a script that prompts for the builder&amp;rsquo;s Tech ID, their AD password, the user ID for the person this computer is assigned to, which part of the business they are in, and what country this computer is going to. The script also records the start time and date of the build as well as the time zone offset (more on that later). This data is written to flat files stored in /tmp/tags/. Then the rest of the install happens, OS is block copied, application packages run, and a second script copies the output of the first script to the newly installed internal drive; /Volumes/Macintosh\ HD/opt/wkstnctl/tags. This is the location that our BigFix install was looking for information from the cloned/hand configured systems. Then the client reboots and does the rest of the package installs and configuration that has to happen while booted to the &amp;ldquo;real&amp;rdquo; OS. The last thing that runs before the final reboot is a script to capture the time the build completes. This is where the time zone offset comes in. I can&amp;rsquo;t rely on the client to have the right time zone at this point. I tried (with help - Thanks MacAdmin Slack) to trigger the system to adjust the time zone automatically, but couldn&amp;rsquo;t make it automatic. So this is where the time zone offset comes into play. I have the original time zone offset and then get the current one and do the math to record completion time that matches the start time. Here is the first script (CaptureBuildInfo.sh) (priority 1): [code language=&amp;ldquo;bash&amp;rdquo;] #!/bin/sh # Capture build info including start time, tech ID, and intended user ID mkdir -p /tmp/tag/ # Record start time and time zone offset echo &amp;quot;$(date +&amp;quot;%D %H:%M&amp;quot;)&amp;quot; &amp;gt; /tmp/tag/BuildStarted.txt echo &amp;quot;$(date +&amp;quot;%z&amp;quot;)&amp;quot; &amp;gt; /tmp/tag/TimeZoneOffset.txt # Some variable defaults for tests techName=&amp;quot;&amp;quot; techNameTest=&amp;quot;false&amp;quot; pwTest=&amp;quot;kinit: Password incorrect&amp;quot; pwCounter=0 endUser=&amp;quot;&amp;quot; endUserTest=&amp;quot;false&amp;quot; pwFileName=&amp;quot;$(uuidgen).txt&amp;quot; #Enter in the URL of the JSS we are are pulling info from. (NOTE: We will need https:// and :8443 (or whatever port you use). Example: &lt;a href=&#34;https://jss.company.com:8443&#34;&gt;https://jss.company.com:8443&lt;/a&gt; ) jssURL=&amp;quot;https://my.jss.tld:8443&amp;quot; #URL for checking with AD adURL=$(host -t SRV _ldap._tcp.my.domain.tld | head -n1 | cut -d&amp;quot; &amp;quot; -f 8 | sed -e &amp;rsquo;s/.$//&amp;rsquo;) #Enter in a username and password that has the correct permissions to the JSS API for what data we need. Read Access to Accounts. jssUser=&amp;quot;apiuser&amp;quot; jssPass=&amp;quot;apipassword!&amp;quot; #Name for XML files pulled from JSS declare -x UserXML=&amp;quot;/tmp/users.xml&amp;quot; #Get list of users from JSS /usr/bin/curl -k -s -u &amp;quot;$jssUser&amp;quot;:&amp;quot;$jssPass&amp;quot; &amp;quot;$jssURL&amp;quot;/JSSResource/accounts -X GET -o &amp;quot;$UserXML&amp;quot; ######################################################################### # Collect and test Tech ID name against JSS imaging accounts # while the entered name all lower case doesn&amp;rsquo;t equal the JSS based name all lower case while [[ $(echo &amp;quot;$techName&amp;quot; | tr [:upper:] [:lower:]) != $(echo &amp;quot;$techNameTest&amp;quot; | tr [:upper:] [:lower:]) ]]; do techName=`/usr/bin/osascript &amp;lt;&amp;lt;EOT tell application &amp;quot;System Events&amp;quot; with timeout of 43200 seconds activate set myReply to text returned of (display dialog &amp;quot;Please enter your Tech ID (first.last):&amp;quot; default answer &amp;quot;&amp;quot; buttons {&amp;quot;Continue&amp;quot;} default button &amp;quot;Continue&amp;quot;) end timeout end tell EOT` # check if collected name is in the list pulled from the JSS # techNameTest will equal the name stored in the JSS if this succeeds # techNameTest will equal &amp;quot;&amp;quot; if this fails techNameTest=$(xmllint &amp;quot;$UserXML&amp;quot; &amp;ndash;xpath &amp;quot;/accounts/users/user/name&amp;quot; | sed &amp;rsquo;s/&amp;lt;name&amp;gt;//g&amp;rsquo; | sed -e $&amp;rsquo;s/&amp;lt;\/name&amp;gt;/\\\n/g&amp;rsquo; | grep -i -m 1 -F &amp;quot;$techName&amp;quot;) done #write the Tech ID to our plist for collection later echo &amp;quot;$techNameTest&amp;quot; &amp;gt; /tmp/tag/TechID.txt ######################################################################### # collect and test Tech password while [ &amp;quot;$pwTest&amp;quot; == &amp;quot;kinit: Password incorrect&amp;quot; ] &amp;amp;&amp;amp; [ $pwCounter -lt 2 ]; do techPW=`/usr/bin/osascript &amp;lt;&amp;lt;EOT tell application &amp;quot;SystemUIServer&amp;quot; with timeout of 43200 seconds activate set myReply to text returned of (display dialog &amp;quot;Please enter your Tech ID password:&amp;quot; with hidden answer default answer &amp;quot;&amp;quot; buttons {&amp;quot;Continue&amp;quot;} default button &amp;quot;Continue&amp;quot;) end timeout end tell EOT` # increment the counter so that we only try twice. Don&amp;rsquo;t want to lock an account pwCounter=$[$pwCounter+1] # sadly, write the password out to a file for the next step echo &amp;quot;$techPW&amp;quot; &amp;gt; /tmp/$pwFileName # Try to authenticate as the tech using the password file # pwTest will equal &amp;quot;kinit: Password incorrect&amp;quot; if the password is wrong. # pwTest will equal &amp;quot;&amp;quot; if the password is right pwTest=$(kinit &amp;ndash;password-file=/tmp/$pwFileName &amp;quot;${techNameTest}@AM.JLLNET.COM&amp;quot; 2&amp;gt;&amp;amp;1 &amp;gt;/dev/null) #OLD and insecure pwTest=$(ldapwhoami -vvv -h &amp;quot;$adURL&amp;quot; -D &amp;quot;${techNameTest}@am.jllnet.com&amp;quot; -x -w &amp;quot;$techPW&amp;quot; | grep Success) #securely erase the password file srm /tmp/$pwFileName done # If they have tried twice and still failed, bail out so as to not lock their account if [ $pwCounter = 2 ] &amp;amp;&amp;amp; [ &amp;quot;$pwTest&amp;quot; == &amp;quot;kinit: Password incorrect&amp;quot; ]; then /usr/bin/osascript &amp;lt;&amp;lt;EOT tell application &amp;quot;SystemUIServer&amp;quot; with timeout of 43200 seconds display dialog &amp;quot;This script can not authenticate you and doesn&amp;rsquo;t want to lock you out of your account. Please verify your password elsewhere and try again.&amp;quot; default button &amp;quot;Cancel&amp;quot; end timeout end tell EOT exit 1 fi ######################################################################### # Collect and test end user id # while the typed name does not equal a name found in AD, keep asking while [[ $(echo &amp;amp;quot;$endUserTest&amp;amp;quot; | tr [:upper:] [:lower:]) != $(echo &amp;amp;quot;$endUser&amp;amp;quot; | tr [:upper:] [:lower:]) ]]; do endUser=`/usr/bin/osascript &amp;amp;lt;&amp;amp;lt;EOT tell application &amp;amp;quot;SystemUIServer&amp;amp;quot; with timeout of 43200 seconds activate set myReply to text returned of (display dialog &amp;amp;quot;Please enter the end user&amp;rsquo;s ID (first.last):&amp;amp;quot; default answer &amp;amp;quot;&amp;amp;quot; buttons {&amp;amp;quot;Continue&amp;amp;quot;} default button &amp;amp;quot;Continue&amp;amp;quot;) end timeout end tell EOT` # check collected name against AD # endUserTest should equal the proper user name from AD if this succeeds # endUserTest will equal &amp;quot;&amp;quot; if this fails #OLD and insecure endUserTest=$(ldapsearch -LLL -x -h &amp;quot;$adURL&amp;quot; -D &amp;quot;${techNameTest}@am.jll.com&amp;quot; -w &amp;quot;$techPW&amp;quot; -b &amp;quot;dc=am,dc=jllnet,dc=com&amp;quot; &amp;quot;(&amp;amp;(objectCategory=Person)(objectClass=User)(sAMAccountName=$endUser))&amp;quot; sAMAccountName | grep sAMAccountName | cut -d&amp;quot; &amp;quot; -f 2) endUserTest=$(ldapsearch -LLL -H &amp;quot;ldap://${adURL}&amp;quot; -b &amp;quot;dc=am,dc=jllnet,dc=com&amp;quot; &amp;quot;(&amp;amp;(objectCategory=Person)(objectClass=User)(sAMAccountName=$endUser))&amp;quot; sAMAccountName 2&amp;gt;/dev/null | grep sAMAccountName | cut -d&amp;quot; &amp;quot; -f 2) done # write the end user info to the plist echo &amp;quot;$endUserTest&amp;quot; &amp;gt; /tmp/tag/JLL_SAM.txt echo &amp;quot;${endUserTest}@am.jll.com&amp;quot; &amp;gt; /tmp/tag/JLL_UserEmailID.txt echo &amp;quot;${endUserTest}@am.jll.com&amp;quot; &amp;gt; /tmp/tag/JLL_UserUPN.txt ######################################################################### # Collect the Business ID from a list businessID=`/usr/bin/osascript &amp;lt;&amp;lt;EOT tell application &amp;quot;SystemUIServer&amp;quot; activate with timeout of 600 seconds set businessID to (choose from list {&amp;quot;Unit 1&amp;quot;, &amp;quot;Unit 2&amp;quot;, &amp;quot;Unit 3&amp;quot;} with prompt &amp;quot;Choose the appropriate\nbusiness unit:&amp;quot; default items {&amp;quot;Unit 1&amp;quot;}) end timeout end tell EOT` #store the business id echo &amp;quot;$businessID&amp;quot; &amp;gt; /tmp/tag/BusinessID.txt ######################################################################### # Collect the Country ID from a list countryID=`/usr/bin/osascript &amp;lt;&amp;lt;EOT tell application &amp;quot;SystemUIServer&amp;quot; activate with timeout of 600 seconds set businessID to (choose from list {&amp;quot;US&amp;quot;, &amp;quot;CA&amp;quot;, &amp;quot;MX&amp;quot;, &amp;quot;SA&amp;quot;} with prompt &amp;quot;Choose the appropriate country:&amp;quot; default items {&amp;quot;US&amp;quot;}) end timeout end tell EOT` #store the country ID echo &amp;quot;$countryID&amp;quot; &amp;gt; /tmp/tag/CountryID.txt #store build version number echo &amp;quot;2.0.0&amp;quot; &amp;gt; /tmp/tag/BuildVersion.txt [/code] It starts by creating a &amp;ldquo;tag&amp;rdquo; directory in /tmp on the boot drive. Then it uses the date command to record the start time and date in the format my organization wants. Then the date command is used again to record the time zone offset with the %z formatting. I then set some default values for variables that will be part of tests later. I also create a unique filename for briefly storing a password later (this is not ideal, but you will see why later). Then I define my JSS address, look up a domain controller, and enter authentication information for a user with JSS API read access. Be sure to adjust these to match your environment. Next I pull a list of accounts from the JSS with the API user and store this in a file (also in /tmp). Now we are ready to prompt for the installers Tech ID. The first time through the test will fail as the two variables are set to not be the same. So then the osascript (AppleScript) will run and collect the users name. That value is used to compare (case insensitive) to the list of accounts on the JSS that was saved earlier. If these match, the test is matched and we move on. Otherwise, the osascript will run again and the installer can try again. Once this is successful, the Tech ID is saved to the tags. Next use a similar loop to check the tech&amp;rsquo;s password. The osascript prompts for a password with a hidden answer. The password is stored in the unique file defined above. As the JSS is populated from our AD, I check the password against AD using kinit. If this is successful, we can break out of the loop and also get a Kerberos ticket granting ticket, which we will use in a bit. If the kinit fails, the tech gets one more chance. If they fail twice, we give up so as to not lock their AD account. Once the kinit has run, I securely remove the password file. At this point we have a valid AD user account that is also allowed on the JSS and that user has a TGT from AD. I then prompt for the ID of the end user this computer will go to. Using the tech&amp;rsquo;s ID and TGT I securely query AD to confirm that the end user ID exists. Once this ldapsearch is successful, the loop exits and the account ID is written to tags for SAM, and then a built email and UPN. The script then prompts for the business unit and country this computer is going to. An osascript shows a list with our most common answer selected by default. These are then stored in tags to be used later for policies to customize the systems. Lastly, the image version is written to a tag. Later in the configuration, script two (CopyBuildInfo.sh) runs (priority 10). [code language=&amp;ldquo;bash&amp;rdquo;] #!/bin/sh # This copies the organizational info from /tmp onto the newly imaged HD. # The info is captured when the image process is started and entered by the tech doing the imaging. if [ -d /tmp/tag ]; then mkdir -p &amp;quot;$1/opt/wkstnctl/&amp;quot; cp -R /tmp/tag &amp;quot;$1/opt/wkstnctl/&amp;quot; fi [/code] This simply confirms that the tag directory exists as a directory and then makes the final destination and copies the tag directory to it. This uses the $1 variable available in Casper Imaging to reference the target volume. The system reboots and any packages that need to be installed while booted from the &amp;ldquo;real&amp;rdquo; OS run. Then lastly, our third script runs. This is named zBuildComplete.sh (so it is last) and is set to run on reboot. [code language=&amp;ldquo;bash&amp;rdquo;] #!/bin/sh # Capture when build is complete timezoneoffset=$(cat /Volumes/Macintosh\ HD/opt/wkstnctl/tag/TimeZoneOffset.txt) case &amp;quot;$timezoneoffset&amp;quot; in -0300) starttz=-3 ;; -0400) starttz=-4 ;; -0500) starttz=-5 ;; -600) starttz=-6 ;; -0700) starttz=-7 ;; -0800) starttz=-8 ;; -0900) starttz=-9 ;; -1000) starttz=-10 ;; esac currenttimezoneoffset=$(date +&amp;quot;%z&amp;quot;) case &amp;quot;$currenttimezoneoffset&amp;quot; in -0300) endtz=-3 ;; -0400) endtz=-4 ;; -0500) endtz=-5 ;; -600) endtz=-6 ;; -0700) endtz=-7 ;; -0800) endtz=-8 ;; -0900) endtz=-9 ;; -1000) endtz=-10 ;; sac difference=$(expr $starttz - $endtz) if [ $difference -eq 0 ]; then completionDate=$(date +&amp;quot;%D %H:%M&amp;quot;) elif [ $difference -gt 0 ]; then completionDate=$(date -v &amp;quot;+${difference}H&amp;quot; +&amp;quot;%D %H:%M&amp;quot;) else completionDate=$(date -v &amp;quot;${difference}H&amp;quot; +&amp;quot;%D %H:%M&amp;quot;) fi echo &amp;quot;$completionDate&amp;quot; &amp;gt; /Volumes/Macintosh\ HD/opt/wkstnctl/tag/BuildComplete.txt [/code] This one is a bit messy. First I read the offset stored from the start and use a case statement to convert it to an integer. Then get the current time zone offset and do the same. Now I can calculate the difference between the two. Then I use that difference to generate a build completion time based on the current time. The date command takes a -v option to adjust the time, but that option needs to have the sign of the change explicit. So there is an if statement to format it properly. If the difference is 0, don&amp;rsquo;t use an adjustment, if the difference is positive, print + then the value, else print the value, which will include the - sign. Once that has all been sorted out, store the completion time in our tags.&lt;/p&gt;</description>
    </item>
    <item>
      <title>FileCruiser - Where are my files?</title>
      <link>http://localhost:1313/posts/filecruiser-where-are-my-files/</link>
      <pubDate>Wed, 10 Feb 2016 16:18:15 +0000</pubDate>
      <guid>http://localhost:1313/posts/filecruiser-where-are-my-files/</guid>
      <description>&lt;p&gt;We are testing a 90-day trial of Promise&amp;rsquo;s &lt;a href=&#34;http://www.promise.com/us/Products/FileCruiser&#34;&gt;FileCruiser&lt;/a&gt;.  It is a private Dropbox look-a-like.  We have been pretty happy with how it works and the performance.  One tricky part is occasionally I have had to try to find the files in the filesystem. If you need to find the data in FileCruiser, it is stored in folders named by a UUID number in &lt;code&gt;/mnt/UserData/MongaStorage/tenants/&amp;lt;UUID&amp;gt;/home/.&lt;/code&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Update to network GeekTool script</title>
      <link>http://localhost:1313/posts/update-to-network-geektool-script-comments/</link>
      <pubDate>Tue, 05 May 2015 21:06:11 +0000</pubDate>
      <guid>http://localhost:1313/posts/update-to-network-geektool-script-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://sneakypockets.wordpress.com/2019/07/29/shell-to-swift-with-a-bit-of-python/&#34; title=&#34;&#34;&gt;Shell to Swift with a bit of Python | My Thoughts&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Jul 1, 2019&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;[…] want to make this too long. So this will be an overview of the project. For years I have had a shell script that collected some network info and it was displayed on my desktop using NerdTool and then […]&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;</description>
    </item>
    <item>
      <title>Update to network GeekTool script</title>
      <link>http://localhost:1313/posts/update-to-network-geektool-script/</link>
      <pubDate>Tue, 05 May 2015 21:06:11 +0000</pubDate>
      <guid>http://localhost:1313/posts/update-to-network-geektool-script/</guid>
      <description>&lt;p&gt;I have been seeing a lot of noise in my logs about IO80211ScanManager scanning for Wi-Fi networks constantly.  I finally noticed that it was triggered by system_profiler and realized that I was using system_profiler to find my current Wi-Fi network and what channel I was connected to. See the original here: &lt;a href=&#34;https://sneakypockets.wordpress.com/2014/08/30/network-services-and-ips/&#34;&gt;https://sneakypockets.wordpress.com/2014/08/30/network-services-and-ips/&lt;/a&gt; So I changed how I find that data in my GeekTool script.  I also took the opportunity to simplify the whole thing a bit more.  Here is the new version: [code language=&amp;ldquo;bash&amp;rdquo;] #! /bin/bash connection=false services=$(networksetup -listallnetworkservices) while read service; do ip=$(networksetup -getinfo &amp;ldquo;$service&amp;rdquo; | grep &amp;ldquo;IP address&amp;rdquo; | grep -v &amp;ldquo;IPv6&amp;rdquo; | awk &amp;lsquo;{print $3}&amp;rsquo;) if [ &amp;ldquo;$ip&amp;rdquo; != &amp;quot;&amp;quot; ]; then echo &amp;ldquo;$service : $ip&amp;rdquo; connection=true if [ &amp;ldquo;$service&amp;rdquo; == &amp;ldquo;Wi-Fi&amp;rdquo; ]; then NetName=$(/System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport -I | grep SSID | grep -v BSSID | cut -d&amp;quot;:&amp;quot; -f2 | tr -d &amp;lsquo;[[:space:]]&amp;rsquo;) Channel=$(/System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport -I | grep channel | cut -d&amp;quot;:&amp;quot; -f2 | tr -d &amp;lsquo;[[:space:]]&amp;rsquo;) echo &amp;ldquo;$NetName / $Channel&amp;rdquo; fi fi done &amp;laquo;&amp;lt;&amp;quot;$services&amp;quot; if [ $connection = false ]; then echo &amp;ldquo;No Connected Services&amp;rdquo; else extIP=$(curl -s &lt;a href=&#34;http://checkip.dyndns.org/&#34;&gt;http://checkip.dyndns.org/&lt;/a&gt; | sed &amp;rsquo;s/[a-zA-Z&amp;lt;&amp;gt;/ :]//g&amp;rsquo;) if [ &amp;ldquo;$extIP&amp;rdquo; != &amp;quot;&amp;quot; ]; then echo &amp;ldquo;External IP: $extIP&amp;rdquo; else echo &amp;ldquo;No External Connection&amp;rdquo; fi fi [/code] Instead of system_profiler the airport command to get the network name and channel.  This stopped the all the message in my logs. I also moved the name and channel logic into the main while read block. This prevents the name and channel from getting separated from the Wi-Fi network IP.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Network Services and IPs</title>
      <link>http://localhost:1313/posts/network-services-and-ips-comments/</link>
      <pubDate>Sat, 30 Aug 2014 22:47:32 +0000</pubDate>
      <guid>http://localhost:1313/posts/network-services-and-ips-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://sneakypockets.wordpress.com/2015/05/05/update-to-network-geektool-script/&#34; title=&#34;&#34;&gt;Update to network GeekTool script | My Thoughts&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;May 2, 2015&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;I have updated this script to be a bit more efficient and stop spamming my logs. See the new version: &lt;a href=&#34;https://sneakypockets.wordpress.com/2015/05/05/update-to-network-geektool-script/&#34;&gt;https://sneakypockets.wordpress.com/2015/05/05/update-to-network-geektool-script/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;</description>
    </item>
    <item>
      <title>Network Services and IPs</title>
      <link>http://localhost:1313/posts/network-services-and-ips/</link>
      <pubDate>Sat, 30 Aug 2014 22:47:32 +0000</pubDate>
      <guid>http://localhost:1313/posts/network-services-and-ips/</guid>
      <description>&lt;p&gt;I have long had a &lt;a href=&#34;http://projects.tynsoe.org/en/geektool/&#34; title=&#34;GeekTool&#34;&gt;GeekTool&lt;/a&gt; item on my desktop that tells me what network interfaces were active and what IPs I have on them, as well as my external IP address.  For a long time this relied on ifconfig and manually updating the interface numbers (en0, en1, etc&amp;hellip;).  Now that I have a Retina MBP, without an ethernet port, I have a lot of possible interfaces with the various adapters.  Managing the script manually was getting annoying.  So I rewrote it to use networksetup and a while loop.  The script is below: [code language=&amp;ldquo;bash&amp;rdquo;]#! /bin/bash connection=false services=$(networksetup -listallnetworkservices) while read service; do ip=$(networksetup -getinfo &amp;ldquo;$service&amp;rdquo; | grep &amp;ldquo;IP address&amp;rdquo; | grep -v &amp;ldquo;IPv6&amp;rdquo; | awk &amp;lsquo;{print $3}&amp;rsquo;) if [ &amp;ldquo;$ip&amp;rdquo; != &amp;quot;&amp;quot; ]; then echo &amp;ldquo;$service : $ip&amp;rdquo; connection=true fi done &amp;lt;&amp;lt;&amp;lt;&amp;quot;$services&amp;quot; astatus=$(networksetup -getinfo &amp;ldquo;Wi-Fi&amp;rdquo; | grep &amp;ldquo;IP address&amp;rdquo; | grep -v &amp;ldquo;IPv6&amp;rdquo; | awk &amp;lsquo;{print $3}&amp;rsquo;) if [ &amp;ldquo;$astatus&amp;rdquo; != &amp;quot;&amp;quot; ]; then NetName=`system_profiler SPAirPortDataType | awk &amp;lsquo;/Current Network Information:/ { found=NR } found &amp;amp;&amp;amp; NR==found+1&amp;rsquo; | awk &amp;lsquo;{$1=$1};1&amp;rsquo; | cut -d&amp;quot;:&amp;quot; -f1` Channel=`system_profiler SPAirPortDataType | awk &amp;lsquo;/Current Network Information:/ { found=NR } found &amp;amp;&amp;amp; NR==found+4&amp;rsquo; | awk &amp;lsquo;{$1=$1};1&amp;rsquo; | sed &amp;rsquo;s/Channel/Ch/g&amp;rsquo;` echo &amp;ldquo;$NetName / $Channel&amp;rdquo; fi if [ $connection = false ]; then echo &amp;ldquo;No Connected Services&amp;rdquo; else extIP=$(curl -s &lt;a href=&#34;http://checkip.dyndns.org/&#34;&gt;http://checkip.dyndns.org/&lt;/a&gt; | sed &amp;rsquo;s/[a-zA-Z&amp;lt;&amp;gt;/ :]//g&amp;rsquo;) if [ &amp;ldquo;$extIP&amp;rdquo; != &amp;quot;&amp;quot; ]; then echo &amp;ldquo;External IP: $extIP&amp;rdquo; else echo &amp;ldquo;No External Connection&amp;rdquo; fi fi [/code] The first line gets a list of all network services as defined in the current location in the Network panel of System Preferences, as well as a few other options (bluetooth, usb attached MiFis, etc).  Then for each one of those, we try to look up an IP address.  If there isn&amp;rsquo;t an IP, nothing is displayed, but if there is, then the service name and IP are output. If the Wi-Fi service has an IP address, then the network name and channel that the system is connected to is found and output. Finally, we use a external website to lookup the public IP that our outside connection is from. [Edit] I added some checking so that if there is no connection, it will display that.  Also it will now display if there is no external connection [/Edit] Currently, this is all for IPv4 addresses, and I explicitly exclude any IPv6 addresses that might be assigned, but that could be modified by changing the grep portions of the script. Then in GeekTool I setup a Shell Script item and point it to my script.  That looks like this: &lt;a href=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2014/08/geektool-config.png&#34;&gt;&lt;img src=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2014/08/geektool-config.png?w=132&#34; alt=&#34;GeekTool config&#34;&gt;&lt;/a&gt; The output then is positioned in the lower left hand corner of my screen and looks like: &lt;a href=&#34;https://sneakypockets.wordpress.com/wp-content/uploads/2014/08/geektool-output1.png&#34;&gt;&lt;img src=&#34;http://sneakypockets.wordpress.com/wp-content/uploads/2014/08/geektool-output1.png?w=300&#34; alt=&#34;GeekTool output&#34;&gt;&lt;/a&gt; The next step is to use this as an excuse to try out &lt;a href=&#34;http://tracesof.net/uebersicht/&#34;&gt;Übersicht&lt;/a&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Unhide /Users in 10.9.3</title>
      <link>http://localhost:1313/posts/unhide-users-in-10-9-3/</link>
      <pubDate>Fri, 16 May 2014 18:31:20 +0000</pubDate>
      <guid>http://localhost:1313/posts/unhide-users-in-10-9-3/</guid>
      <description>&lt;p&gt;[Further Edit] The below was fixed by Apple.  This is no longer necessary, but I&amp;rsquo;ll leave it here incase the ideas help someone. [/Further Edit] [Edit] So the below doesn&amp;rsquo;t actually work. Something changes the permissions and hidden flag after my launch daemon runs. I added a check of the files (just ls &amp;gt; to a file) and they get set correctly but by the time I am logged in something has changed it back. [/edit] The recent 10.9.3 update has made a strange change for a number of OS X users.  The directory that holds everyone&amp;rsquo;s home folder, /Users, has been hidden along with the /Users/Shared folder. A number of people have found a solution using chflags as follows: [code language=&amp;ldquo;bash&amp;rdquo;]sudo chflags nohidden /Users sudo chflags nohidden /Users/Shared[/code] But this doesn&amp;rsquo;t last through a reboot. Not as widely reported, there has also been a permissions change to /Users making it writable by the wheel group and everyone. I have seen an Applescript used as a login item to change the settings back, but this runs every time a user logs in, when the process only needs to run after each reboot.  So I put together another option that uses a launch daemon and a shell script. The shell script is: [code language=&amp;ldquo;bash&amp;rdquo;]#!/bin/sh chmod 755 /Users chflags nohidden /Users chflags nohidden /Users/Shared[/code] This should get saved in /Library/Scripts/fixUsersFolder.sh and then made executable. Then the launchd plist is: [code language=&amp;ldquo;xml&amp;rdquo;]&amp;amp;amp;lt;?xml version=&amp;amp;amp;quot;1.0&amp;amp;amp;quot; encoding=&amp;amp;amp;quot;UTF-8&amp;amp;amp;quot;?&amp;amp;amp;gt; &amp;amp;amp;lt;!DOCTYPE plist PUBLIC &amp;amp;amp;quot;-//Apple//DTD PLIST 1.0//EN&amp;amp;amp;quot; &amp;amp;amp;quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&amp;amp;amp;quot;&amp;amp;amp;gt; &amp;amp;amp;lt;plist version=&amp;amp;amp;quot;1.0&amp;amp;amp;quot;&amp;amp;amp;gt; &amp;amp;amp;lt;dict&amp;amp;amp;gt; &amp;amp;amp;lt;key&amp;amp;amp;gt;Label&amp;amp;amp;lt;/key&amp;amp;amp;gt; &amp;amp;amp;lt;string&amp;amp;amp;gt;com.sneakypockets.fixHidden&amp;amp;amp;lt;/string&amp;amp;amp;gt; &amp;amp;amp;lt;key&amp;amp;amp;gt;Program&amp;amp;amp;lt;/key&amp;amp;amp;gt; &amp;amp;amp;lt;string&amp;amp;amp;gt;/Library/Scripts/fixUsersFolder.sh&amp;amp;amp;lt;/string&amp;amp;amp;gt; &amp;amp;amp;lt;key&amp;amp;amp;gt;RunAtLoad&amp;amp;amp;lt;/key&amp;amp;amp;gt; &amp;amp;amp;lt;true/&amp;amp;amp;gt; &amp;amp;amp;lt;/dict&amp;amp;amp;gt; &amp;amp;amp;lt;/plist&amp;amp;amp;gt; [/code] This should be saved to /Library/LaunchDaemons/com.sneakypockets.fixHidden.plist. Now when you boot your computer, launchd will run the script and put the Users directory and Shared directory back to there old style.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Find the most common user on a system</title>
      <link>http://localhost:1313/posts/find-the-most-common-user-on-a-system/</link>
      <pubDate>Thu, 07 Nov 2013 01:46:51 +0000</pubDate>
      <guid>http://localhost:1313/posts/find-the-most-common-user-on-a-system/</guid>
      <description>&lt;p&gt;I wrote this shell script for a client that was using JAMF&amp;rsquo;s Casper Suite.  It is in the form of an extended attribute, but can easily be changed to output as you want. The script uses the last command to find all the previous logins and then finds the most common user and reports it.  If less than 10 logins have occurred, the script reports the most recent login.```&#xA;#!/bin/sh&lt;/p&gt;</description>
    </item>
    <item>
      <title>Keyboard shortcut for System Preferences</title>
      <link>http://localhost:1313/posts/keyboard-shortcut-for-system-preferences/</link>
      <pubDate>Wed, 06 Nov 2013 16:17:26 +0000</pubDate>
      <guid>http://localhost:1313/posts/keyboard-shortcut-for-system-preferences/</guid>
      <description>&lt;p&gt;I just had a student in class ask about a keyboard shortcut for System Preferences.  There isn&amp;rsquo;t one built-in, but we can make one. Open System Preferences and select the Keyboard panel.  Then select the Shortcuts tab.  On the left choose the App Shortcuts entry and click the plus sign below the box on the right. &lt;a href=&#34;http://sneakypockets.wordpress.com/wp-content/uploads/2013/11/screen-shot-2013-11-06-at-10-11-22-am.png&#34;&gt;&lt;img src=&#34;http://sneakypockets.wordpress.com/wp-content/uploads/2013/11/screen-shot-2013-11-06-at-10-11-22-am.png?w=300&#34; alt=&#34;Screen Shot 2013-11-06 at 10.11.22 AM&#34;&gt;&lt;/a&gt; In the sheet that drops down leave the menu on All Applications (this keyboard shortcut should always work).  Then for the Menu Title enter &amp;ldquo;System Preferences&amp;hellip;&amp;rdquo;.  This should exactly match the actual command in the menu.  Interestingly, using 3 periods instead of an ellipsis (…) works fine.  Then click in the Keyboard Shortcut field and press the keys you want to use. Click Add.&lt;a href=&#34;http://sneakypockets.wordpress.com/wp-content/uploads/2013/11/screen-shot-2013-11-06-at-10-11-41-am.png&#34;&gt;&lt;img src=&#34;http://sneakypockets.wordpress.com/wp-content/uploads/2013/11/screen-shot-2013-11-06-at-10-11-41-am.png?w=300&#34; alt=&#34;Screen Shot 2013-11-06 at 10.11.41 AM&#34;&gt;&lt;/a&gt; I chose option-command-comma since command-comma is used for application preferences. Now from anywhere, you should be able to type your keyboard shortcut to open System Preferences.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Control if a window opens when a volume mounts</title>
      <link>http://localhost:1313/posts/control-if-a-window-opens-when-a-volume-mounts/</link>
      <pubDate>Wed, 06 Nov 2013 14:04:24 +0000</pubDate>
      <guid>http://localhost:1313/posts/control-if-a-window-opens-when-a-volume-mounts/</guid>
      <description>&lt;p&gt;This may not be as applicable anymore with Mavericks and the new createinstallmedia command, but it was relatively common to make a copy of the OS X Installer media onto a firewire or USB drive to allow for faster installs than from a CD or DVD. One issue with this was always that when the drive is mounted, the Finder would open a window to show the installer.  This was fine if there was only one volume on the drive, you probably wanted it open, but often a drive would have multiple installer partitions and a few bootable partitions and maybe a data partition as well. We don&amp;rsquo;t want any of that to open automatically. The bless command is the way to control if a drive&amp;rsquo;s window is opened automatically.  Replace &lt;em&gt;externaldrive&lt;/em&gt; with your volume&amp;rsquo;s name. On a drive that doesn&amp;rsquo;t auto open,&lt;/p&gt;</description>
    </item>
    <item>
      <title>Get the path of file onto the clipboard</title>
      <link>http://localhost:1313/posts/get-the-path-of-file-onto-the-clipboard-comments/</link>
      <pubDate>Wed, 06 Nov 2013 03:37:51 +0000</pubDate>
      <guid>http://localhost:1313/posts/get-the-path-of-file-onto-the-clipboard-comments/</guid>
      <description>&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;&#xA;&lt;p&gt;&lt;a href=&#34;http://www.sutocom.net&#34; title=&#34;dennes777@gmail.com&#34;&gt;SutoCom&lt;/a&gt; - &lt;!-- raw HTML omitted --&gt;Nov 4, 2013&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;&#xA;&lt;p&gt;Reblogged this on &lt;a href=&#34;http://sutocom.net/2013/11/07/get-the-path-of-file-onto-the-clipboard/&#34;&gt;Sutoprise Avenue, A SutoCom Source&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;!-- raw HTML omitted --&gt;</description>
    </item>
    <item>
      <title>Get the path of file onto the clipboard</title>
      <link>http://localhost:1313/posts/get-the-path-of-file-onto-the-clipboard/</link>
      <pubDate>Wed, 06 Nov 2013 03:37:51 +0000</pubDate>
      <guid>http://localhost:1313/posts/get-the-path-of-file-onto-the-clipboard/</guid>
      <description>&lt;p&gt;I find myself needing the path to a file relatively frequently to add to an email or documentation.  I added a service to the Finder contextual menu to get the path to the selected item.  This service notifies me with an alert (just for fun) and can be invoked with a keyboard shortcut.  This was done in Mavericks (10.9).  Most of it should work in 10.8 or 10.7 (except the notification). To start, open Automator (/Applications/Automator.app) and choose to make a New Document. When prompted, select to create a Service and click Choose. &lt;a href=&#34;http://sneakypockets.wordpress.com/wp-content/uploads/2013/11/screen-shot-2013-11-05-at-9-12-00-pm.png&#34;&gt;&lt;img src=&#34;http://sneakypockets.wordpress.com/wp-content/uploads/2013/11/screen-shot-2013-11-05-at-9-12-00-pm.png?w=300&#34; alt=&#34;Screen Shot 2013-11-05 at 9.12.00 PM&#34;&gt;&lt;/a&gt; This will create a new workflow that takes the selected items as input.  Change the &amp;ldquo;Service receives selected&amp;rdquo; menu to say &amp;ldquo;Files or Folders&amp;rdquo; and change &amp;ldquo;any application&amp;rdquo; to be &amp;ldquo;Finder&amp;rdquo;. Then we need to add the appropriate actions. First we need to get the actual path to the selected item. There isn&amp;rsquo;t an action to do this exactly, so add the Run AppleScript action.  Replace &amp;ldquo;(* Your script goes here *)&amp;rdquo; with:```&#xA;&lt;strong&gt;tell&lt;/strong&gt; &lt;em&gt;application&lt;/em&gt; &amp;ldquo;Finder&amp;rdquo;&#xA;&lt;strong&gt;return&lt;/strong&gt; POSIX path &lt;strong&gt;of&lt;/strong&gt; input&#xA;&lt;strong&gt;end&lt;/strong&gt; &lt;strong&gt;tell&lt;/strong&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
