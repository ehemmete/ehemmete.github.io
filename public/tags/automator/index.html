<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>My Thoughts</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.135.0">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    
    
      <link href="/tags/automator/index.xml" rel="alternate" type="application/rss+xml" title="My Thoughts" />
      <link href="/tags/automator/index.xml" rel="feed" type="application/rss+xml" title="My Thoughts" />
      
    

    
      <link rel="canonical" href="http://localhost:1313/tags/automator/">
    

    <meta property="og:url" content="http://localhost:1313/tags/automator/">
  <meta property="og:site_name" content="My Thoughts">
  <meta property="og:title" content="Automator">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="website">

  <meta itemprop="name" content="Automator">
  <meta itemprop="datePublished" content="2018-03-26T13:07:22+00:00">
  <meta itemprop="dateModified" content="2018-03-26T13:07:22+00:00">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Automator">

	
  </head>

  <body class="ma0 avenir bg-near-white">

    

  <header>
    <div class="pb3-m pb6-l bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        My Thoughts
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

      <div class="tc-l pv3 ph3 ph4-ns">
        <h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">
          Automator
        </h1>
        
      </div>
    </div>
  </header>


    <main class="pb7" role="main">
      
  <article class="cf pa3 pa4-m pa4-l">
    <div class="measure-wide-l center f4 lh-copy nested-copy-line-height nested-links mid-gray">
      <p>Below you will find pages that utilize the taxonomy term “Automator”</p>
    </div>
  </article>
  <div class="mw8 center">
    <section class="flex-ns flex-wrap justify-around mt5">
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/new-folder-in-list-view-comments/" class="link black dim">
        New Folder in List View
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <h4 id="heading"></h4>
<p><a href="%22anthonymolina62@yahoo.com%22">Anthony</a> - <!-- raw HTML omitted -->May 3, 2020<!-- raw HTML omitted --></p>
<p>Found your page on a web search. Exactly what I was looking for, it&rsquo;s awesome. Thank you !</p>
<!-- raw HTML omitted -->
<p>Hey thanks for this. Works like a charm! Why Apple does not have something like this built-in is beyond me.</p>
<!-- raw HTML omitted -->
<p>This is soooooooooo helpful! Thanx</p>
<!-- raw HTML omitted -->
    </div>
    <a href="/posts/new-folder-in-list-view-comments/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/new-folder-in-list-view/" class="link black dim">
        New Folder in List View
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>I often use List View in the Finder for the directory where I organize all my packages.  There doesn&rsquo;t seem to be any way to create a folder within the highlighted folder below.<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2018/03/screen-shot-2018-03-23-at-4-48-33-pm.png" alt="Screen Shot 2018-03-23 at 4.48.33 PM.png"> In this post I will show how we can create that option.  Right-click/Control-click doesn&rsquo;t have a New Folder option in this view.  The File menu/Action menu/keyboard shortcut for New Folder makes a the new folder in the folder that is at the root of the window.  That doesn&rsquo;t work for me since there are so many folders in this directory that I lose my place. We can use AppleScript to make a new folder and Automator to make it a Service that will be available in the right-click menu.  Open Automator and choose to make a New Document and Choose to make it a Service.<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2018/03/screen-shot-2018-03-23-at-4-56-03-pm.png" alt="Screen Shot 2018-03-23 at 4.56.03 PM.png"> Then search on the left for Run.  Drag a Run AppleScript action into the workflow on the right.  Then change the dropdowns to &ldquo;Service receives selected folders in Finder&rdquo;<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2018/03/screen-shot-2018-03-23-at-4-58-57-pm.png" alt="Screen Shot 2018-03-23 at 4.58.57 PM.png"> The AppleScript block will be passed the folder we have selected in the Finder as <code>input</code>.  We can use that to know where to make our new folder.  We could just use:<code>tell application &quot;Finder&quot; make new folder at input end tell</code>to make a new folder, but then we have to rename it.  Since we are already using AppleScript, I decided to prompt for the name up front.  So my final AppleScript looks like```
on run {input, parameters}
set folderNameDialog to display dialog &ldquo;Enter the folder name:&rdquo; default answer &quot;&quot; buttons {&ldquo;OK&rdquo;} default button &ldquo;OK&rdquo;
set folderName to text returned of folderNameDialog
tell application &ldquo;Finder&rdquo;
make new folder at input with properties {name:folderName}
end tell
return input
end run</p>
    </div>
    <a href="/posts/new-folder-in-list-view/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/automator-application-to-run-script-as-root-comments/" class="link black dim">
        Automator application to run script as root
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <h4 id="heading"></h4>
<p><a href="http://rayleighwickfordlabour.org.uk" title="n.martin@rayleighwickfordlabour.org.uk">n.martin</a> - <!-- raw HTML omitted -->Dec 2, 2017<!-- raw HTML omitted --></p>
<p>Heyas - it looks like you might be using Jamf from the last screenshot (jamfhelper?). If you&rsquo;re running Jamf Pro 10, you could put the installer policy in Self Service and get a URL that opens Self Service and runs that policy automatically: <a href="http://docs.jamf.com/10.0.0/jamf-pro/administrator-guide/Making">http://docs.jamf.com/10.0.0/jamf-pro/administrator-guide/Making</a>_Items_Available_to_Users_in_Jamf_Self_Service_for_macOS.html There&rsquo;s a section on that page; Item URLs An AppleScript with: do shell script &ldquo;open &quot; might work (haven&rsquo;t tested but would be really interested).</p>
    </div>
    <a href="/posts/automator-application-to-run-script-as-root-comments/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/automator-application-to-run-script-as-root/" class="link black dim">
        Automator application to run script as root
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>I was recently asked to create a shortcut on our users&rsquo; Desktops to kick off the High Sierra install. We are caching the installer through our management system. In the past I have created a shortcut to the installer on their Desktop, but that required them to click through the many continue buttons. This method will use the startosinstall script from <a href="https://github.com/bp88/JSS-Scripts/blob/master/OS_Upgrade.sh">Slack member @bp</a> to start the install with minimal user interaction. I wrap that shell script (with the appropriate modifications for my environment) in an Automator application, but to have the script run as root, I call it with Run AppleScript using the <code>do shell script ... with administrator privileges</code> form. <img src="https://sneakypockets.wordpress.com/wp-content/uploads/2017/12/automatorinstaller.png" alt="AutomatorInstaller.png"> The full AppleScript is</p>
    </div>
    <a href="/posts/automator-application-to-run-script-as-root/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/signing-installer-packages-with-automator-comments/" class="link black dim">
        Signing Installer Packages with Automator
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <h4 id="heading"></h4>
<p><a href="%22developers@buildtestrun.com%22">mbonne</a> - <!-- raw HTML omitted -->Apr 5, 2019<!-- raw HTML omitted --></p>
<p>+1 automation services levelled up</p>
<!-- raw HTML omitted -->
<p>[…] is created, drag it to the Post-installation well, save your package, and build it. I then sign my packages with a certificate from my company’s Apple developer […]</p>
<!-- raw HTML omitted -->
    </div>
    <a href="/posts/signing-installer-packages-with-automator-comments/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/signing-installer-packages-with-automator/" class="link black dim">
        Signing Installer Packages with Automator
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>Apple packages (.pkgs) are opened by the GUI Installer.app or the command line installer command. If a package is unsigned and gets a quarantine flag (from being transferred over a network), the GUI Installer will refuse to run it.<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-07-35-pm.png" alt="Screen Shot 2016-11-02 at 3.07.35 PM.png"> We can get around that with a right-click -&gt; Open, but we shouldn&rsquo;t be training computer users to ignore security warnings like this. <img src="https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-04-at-4-49-33-pm.png" alt="Screen Shot 2016-11-04 at 4.49.33 PM.png"> If you are creating your own packages, and users or techs may run them manually, then you really should be signing them. Even if you are deploying them in a way that a person won&rsquo;t see a warning, signing packages can be very easy and provide a check that nothing changed since you created it. See below the break for how to easily automate signing packages. I use <a href="http://s.sudre.free.fr/Software/Packages/about.html">WhiteBox Packages</a> to create most of my packages. It has a built in feature to sign packages it builds, but recent versions have had some problems with it and when it works it still has to be set per package project. The Apple provided tool to sign our packages is <code>productsign</code>. This works, but to make things easier on myself, I have wrapped that up in an Automator application that I can use as a droplet. The basic format for using productsign is <code>productsign [options] --sign identity input-product-path output-product-path</code> Interestingly, the man page for productsign doesn&rsquo;t show any available options. So next we want to <code>--sign</code> using <code>identity</code>. This is our Developer ID Installer certificate from Apple&rsquo;s developer program. This does require a paid membership, but if you work for an organization supporting Macs, there is plenty of benefit to offset the $99 or $399/year (signing identities, early access to OS builds for testing, etc). To sign packages we need a Developer ID Installer (see <a href="https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/MaintainingCertificates/MaintainingCertificates.html#//apple_ref/doc/uid/TP40012582-CH31-SW6">Apple&rsquo;s documentation</a>) Once you have your Dev ID Installer certificate installed in your keychain, then we can get the appropriate reference for it. Open /Applications/Utilities/Keychain Access. Search for Developer ID and select the appropriate certificate. Then you can highlight and copy the name.  If you are a part of more than one developer program, select the &ldquo;right&rdquo; one here.  You can create several Automator applications if you want to have one for each ID.<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-25-14-pm.png" alt="Screen Shot 2016-11-02 at 3.25.14 PM.png"> So now we can write our command <code>productsign --sign 'Developer ID Installer: OrgName (Code)' in_pkg out_pkg</code>. For example <code>productsign --sign 'Developer ID Installer: OrgName (Code)' ~/Development/Unsigned.pkg ~/Development/Signed.pkg</code>. This will prompt to allow productsign access to your keychain. Say Allow or Always Allow.<code>$ productsign --sign 'Developer ID Installer: OrgName (Code)' ~/Desktop/Unsigned/build/Unsigned.pkg ~/Desktop/Unsigned/build/Signed.pkg productsign: using timestamp authority for signature productsign: signing product with identity &quot;Developer ID Installer: OrgName (Code)&quot; from keychain /Users/username/Library/Keychains/login.keychain-db productsign: adding certificate &quot;Developer ID Certification Authority&quot; productsign: adding certificate &quot;Apple Root CA&quot; productsign: Wrote signed product archive to /Users/username/Desktop/Unsigned/build/Signed.pkg</code>Now when we run the installer by double clicking it, the installer opens. Notice the lock in the upper right corner. Click the clock and we can examine the certificate chain back to Apple&rsquo;s Root.<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-29-14-pm1.png" alt="Screen Shot 2016-11-02 at 3.29.14 PM.png"> The idea when we started was to make this easy to do since we might need to sign a lot of packages over time. To automate this, open /Applications/Automator.app. Choose to create a New Document. Then choose Application for the type and click Choose.<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-31-43-pm.png" alt="Screen Shot 2016-11-02 at 3.31.43 PM.png"> Search for shell in the Actions name search field. Drag a run shell script action to the workflow.<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-32-11-pm.png" alt="Screen Shot 2016-11-02 at 3.32.11 PM.png"> First adjust the Pass input: pop up to as arguments.<img src="https://sneakypockets.wordpress.com/wp-content/uploads/2016/11/screen-shot-2016-11-02-at-3-33-00-pm.png" alt="Screen Shot 2016-11-02 at 3.33.00 PM.png"> That will fill in the template for us. Then enter our productsign command with some slight differences. The <code>--sign</code> and <code>identity</code> will be the same, but now for the input and output, we need to make this work with whatever is dropped on the application. The packages will be passed as arguments and the for loop will work on each one in turn. These will be assigned to the pkg variable, so that becomes our input file. Then for the output, I settled on packagename.signed.pkg to differentiate the output from the input. This <code>$(sed 's/.pkg$/.signed.pkg/g' &lt;&lt;&lt; $pkg)</code> will find the last &lsquo;.pkg&rsquo; in the filename and replace it with &lsquo;.signed.pkg&rsquo;, while keeping the name portion the same (see note at the end for how this works) .  Notice I also changed the <code>f</code> to <code>pkg</code> just to make it clear what the variable represents.```
for pkg in &ldquo;$@&rdquo;
do
productsign &ndash;sign &lsquo;Developer ID Installer: OrgName (Code)&rsquo; &ldquo;$pkg&rdquo; &ldquo;$(sed &rsquo;s/.pkg$/.signed.pkg/g&rsquo; &laquo;&lt; $pkg)&rdquo;
done</p>
    </div>
    <a href="/posts/signing-installer-packages-with-automator/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/get-the-path-of-file-onto-the-clipboard-comments/" class="link black dim">
        Get the path of file onto the clipboard
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <h4 id="heading"></h4>
<p><a href="http://www.sutocom.net" title="dennes777@gmail.com">SutoCom</a> - <!-- raw HTML omitted -->Nov 4, 2013<!-- raw HTML omitted --></p>
<p>Reblogged this on <a href="http://sutocom.net/2013/11/07/get-the-path-of-file-onto-the-clipboard/">Sutoprise Avenue, A SutoCom Source</a>.</p>
<!-- raw HTML omitted -->
    </div>
    <a href="/posts/get-the-path-of-file-onto-the-clipboard-comments/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/get-the-path-of-file-onto-the-clipboard/" class="link black dim">
        Get the path of file onto the clipboard
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>I find myself needing the path to a file relatively frequently to add to an email or documentation.  I added a service to the Finder contextual menu to get the path to the selected item.  This service notifies me with an alert (just for fun) and can be invoked with a keyboard shortcut.  This was done in Mavericks (10.9).  Most of it should work in 10.8 or 10.7 (except the notification). To start, open Automator (/Applications/Automator.app) and choose to make a New Document. When prompted, select to create a Service and click Choose. <a href="http://sneakypockets.wordpress.com/wp-content/uploads/2013/11/screen-shot-2013-11-05-at-9-12-00-pm.png"><img src="http://sneakypockets.wordpress.com/wp-content/uploads/2013/11/screen-shot-2013-11-05-at-9-12-00-pm.png?w=300" alt="Screen Shot 2013-11-05 at 9.12.00 PM"></a> This will create a new workflow that takes the selected items as input.  Change the &ldquo;Service receives selected&rdquo; menu to say &ldquo;Files or Folders&rdquo; and change &ldquo;any application&rdquo; to be &ldquo;Finder&rdquo;. Then we need to add the appropriate actions. First we need to get the actual path to the selected item. There isn&rsquo;t an action to do this exactly, so add the Run AppleScript action.  Replace &ldquo;(* Your script goes here *)&rdquo; with:```
<strong>tell</strong> <em>application</em> &ldquo;Finder&rdquo;
<strong>return</strong> POSIX path <strong>of</strong> input
<strong>end</strong> <strong>tell</strong></p>
    </div>
    <a href="/posts/get-the-path-of-file-onto-the-clipboard/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
    </section>
  </div>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Eric Hemmeter 2024 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
